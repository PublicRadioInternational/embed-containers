var EntityEmbed=EntityEmbed||{};!function(){function e(e){return e=$.extend(!0,{},n,e),e.data.debug=e.debug,$.support.cors=!0,$.ajax({timeout:15e3,crossDomain:!0,type:e.methodType,dataType:"json",url:e.path,data:JSON.stringify(e.data)}).done(e.success).fail(e.fail).always(e.always)}function t(){var e=/^[^.]*staging[^.]*\.|\.dev$/,t=e.test(window.location.host);t&&(n.debug=1)}var n={success:function(){},fail:function(){},always:function(){},data:{},debug:0,path:""};t.prototype.put=function(t){return t.methodType="POST",e(t)},t.prototype.post=function(t){return t.methodType="POST",e(t)},t.prototype.get=function(t){return t.methodType="POST",e(t)},EntityEmbed.apiService=new t}();var EntityEmbed=EntityEmbed||{};!function(){var e={},t="entity-embed-active",n="medium-editor-button-active",i="medium-insert-images-toolbar",o="medium-insert-images-toolbar2",a="entity-embed-secondary-toolbar-locator",r=function(e,t){var n="";t?(n="medium-insert-images-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active ",n+=t+"StyleToolbar"):n="medium-insert-images-toolbar2 medium-editor-toolbar medium-editor-toolbar-active";var i='<div class="'+n+'"><ul class="medium-editor-toolbar-actions clearfix">';for(var o in e){var a=e[o];a.label&&(i+='<li><button class="medium-editor-action" data-action="'+o+'">'+a.label+"</button></li>")}return i+="</ul></div>"};toolbarManager=function(e,n,i,o){var a=this;a.mediumEditorAddon=e,a.styles=n,a.actions=i,o&&(t=o),a.events()},toolbarManager.prototype.events=function(){var e=this;$(document).on("click","."+i+" .medium-editor-action",function(){e.styleToolbarDo($(this))}).on("click","."+o+" .medium-editor-action",function(){e.actionToolbarDo($(this))})},toolbarManager.prototype.createActionToolbar=function(e){var t=this;e.append(r(t.actions)),t.$actionToolbar=$("."+o),t.$actionToolbar.hide()},toolbarManager.prototype.createStyleToolbar=function(t,n){var o=this,a=$.extend(o.styles,{}),s=!0;if(n.options.styles){for(var l in n.options.styles)n.options.styles[l]?s=!1:delete a[l];s||(t.append(r(a,n.name)),e[n.name]=$("."+i+"."+n.name+"StyleToolbar"),e[n.name].hide())}},toolbarManager.prototype.showToolbars=function(i,o){var a,r=this,s=$("."+t);r.currentToolbarEmbedType=o,r.$actionToolbar.show(),e[r.currentToolbarEmbedType]&&(e[r.currentToolbarEmbedType].find("button").each(function(){s.hasClass("entity-embed-"+$(this).data("action"))&&(a=$(this),a.addClass(n))}),e[r.currentToolbarEmbedType].show(),a&&a.addClass(n)),r.positionToolbars(i)},toolbarManager.prototype.styleToolbarDo=function(e){var i=this,o=e.closest("li").closest("ul"),a=$("."+t);o.find("."+n).removeClass(n),e.addClass(n),o.find("button").each(function(){var e=$(this),t="entity-embed-"+e.data("action");e.hasClass(n)?i.addStyle(a,t,e.data("action"),!0):(a.removeClass(t),i.styles[e.data("action")].removed&&i.styles[e.data("action")].removed(a))})},toolbarManager.prototype.addStyle=function(e,n,i,o){var a=this;e.addClass(n),a.styles[i].added&&a.styles[i].added(e),o&&setTimeout(function(){a.positionToolbars($("."+t))},50)},toolbarManager.prototype.actionToolbarDo=function(e){var n=this,i=$("."+t),o=n.actions[e.data("action")].clicked;o(n.mediumEditorAddon,i)},toolbarManager.prototype.hideToolbar=function(){var t=this;t.$actionToolbar.hide(),t.$actionToolbar.find("button").removeClass(n),t.currentToolbarEmbedType&&e[t.currentToolbarEmbedType]&&(e[t.currentToolbarEmbedType].hide(),e[t.currentToolbarEmbedType].find("button").removeClass(n),t.currentToolbarEmbedType=null)},toolbarManager.prototype.positionToolbars=function(t){var n=this,i=t.find("."+a);0===i.length&&(i=t),s=t.offset().top+2;var o=i.offset().left+i.width()+4;o>$(window).width()-n.$actionToolbar.width()&&(s-=n.$actionToolbar.height()+8,o=$(window).width()-n.$actionToolbar.width()-50),n.$actionToolbar.css({top:s,left:o});var r=e[n.currentToolbarEmbedType];if(r){var s=t.offset().top-r.height()-8-2-5;0>s&&(s=0),r.css({top:s,left:t.offset().left+t.width()/2-r.width()/2})}},EntityEmbed.toolbarManager=toolbarManager}();var EntityEmbedTypes=EntityEmbedTypes||{},EntityEmbed=EntityEmbed||{};!function(){"use strict";function e(e,t,n,i){var o=i||this;o.name=n,t=$.extend(!0,{},o.defaultOptions,t),o.options=$.extend(!0,{},t,e),o.init()}e.prototype.defaultOptions={viewPath:"",displayName:"Generic",httpPaths:{put:"https://test-services.pri.org/admin/embed/edit",post:"https://test-services.pri.org/admin/embed/edit",get:"https://test-services.pri.org/admin/embed/fetch",getAll:"https://test-services.pri.org/admin/embed/list"},styles:{left:!0,right:!0,center:!0,wide:!0},validationOptions:{}},e.prototype.cleanModel=function(){return{}},e.prototype.defaultStyle="entity-embed-center",e.prototype.init=function(){var e=this;e.model=e.cleanModel()},e.prototype.initModal=function(e){},e.prototype.getModelFromForm=function(e){for(var t=this,n=e.find(".embed-modal-form-control"),i=0;i<n.length;i++){var o=n[i].name,a=n[i].value;o&&a&&(t.model[o]=a)}},e.prototype.populateFormWithModel=function(e){for(var t=this,n=e.find(".embed-modal-form-control"),i=0;i<n.length;i++)if(n[i].type&&-1!==n[i].type.indexOf("select")){var o=$(n[i]).find("option"),a=t.model[n[i].name],r=0;o.each(function(e){this.value===a&&(r=e)}),n[i].selectedIndex=r}else t.model[n[i].name]&&(n[i].value=t.model[n[i].name])},e.prototype.clearForm=function(e,t){function n(){t.$validator&&t.$validator.resetForm()}t=t?t:this,n(t);for(var i=e.find("form"),o=0;o<i.length;o++)i[o].reset();t.model=t.cleanModel()},e.prototype.editorEvents=function(){},e.prototype.parseForEditor=function(){return'<pre class="embedded-content">'+JSON.stringify(this.model,null,4)+"</pre>"},e.prototype.validate=function(e){var t=this,n=e.find("form");return t.$validator=n.validate(t.options.validationOptions),t.$validator},e.prototype.saveEmbed=function(e,t,n,i){var o=this;return o.model.auth_token="abc123",e?(o.model.object_type=o.options.object_type,EntityEmbed.apiService.post({path:o.options.httpPaths.post,data:o.model,success:t,fail:n,always:i})):EntityEmbed.apiService.put({path:o.options.httpPaths.put,data:o.model,success:t,fail:n,always:i})},EntityEmbedTypes.genericEmbed=e,Function.prototype.inherits||(Function.prototype.inherits=function(e){var t=this;return t.prototype=new e,t.prototype.constructor=t,t.prototype.parent=e.prototype,t})}(),function(){"use strict";function e(e,n,i){var o=this;o.$el=$(e),o.options=$.extend(!0,{},t,n),o.scope={},i&&(o.scope=i),o.scope.modalCtrl=o,o.$el.data("scope",o.scope),o.options.functions.init.before(o.scope),o.init(),o.options.functions.init.after(o.scope)}var t={contentClass:"embed-modal",backdropClass:"embed-modal-backdrop",closeBtnIcon:"fa fa-times",showCloseBtn:!0,$openEl:$(""),$abortEl:$(""),$completeEl:$(""),functions:{init:{before:function(e){},after:function(e){}},open:{before:function(e){},after:function(e){}},abort:{before:function(e){return!0},after:function(e){}},complete:{before:function(e){return!0},after:function(e){}}}};e.prototype.isActive=!1,e.prototype.activeClass="em-active",e.prototype.closeBtnClass="em-close-btn",e.prototype.generateId=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.prototype.backdropHtml=function(e){var t=this;return'<div id="'+e+'" class="'+t.options.backdropClass+'"></div>'},e.prototype.closeBtnHtml=function(e){var t=this,n=t.closeBtnClass+" "+t.options.closeBtnIcon;return'<i id="'+e+'"" class="'+n+'"></i>'},e.prototype.toggle=function(e){e.$el.toggleClass(e.activeClass),e.$backdrop.toggleClass(e.activeClass),e.$closeBtn.toggleClass(e.activeClass),e.isActive=!e.isActive},e.prototype.init=function(){var e=this;e.$el.addClass(e.options.contentClass);var t=e.generateId();if(e.$el.before(e.backdropHtml(t)),e.$backdrop=$("#"+t),e.$backdrop.click(function(){e.$el.abortModal()}),e.options.showCloseBtn){var n=e.generateId();e.$el.prepend(e.closeBtnHtml(n)),e.$closeBtn=$("."+e.closeBtnClass+"#"+n),e.$closeBtn.click(function(){e.$el.abortModal()})}e.options.$openEl.click(function(){e.$el.openModal()}),e.options.$completeEl.click(function(){e.$el.completeModal()}),e.options.$abortEl.click(function(){e.$el.abortModal()})},e.prototype.registerEvent=function(e,t,n,i){var o=this;o.$el.find(e).on(t,function(e){n(e,o.$el.data("scope"),i)})},$.fn.modal=function(t,n){return this.each(function(){$.data(this,"ctrl")||(t||(t={}),$.data(this,"ctrl",new e(this,t,n)))})},$.fn.openModal=function(e){return this.each(function(){var t=$.data(this,"ctrl");if(t&&!t.isActive){if(e){var n=t.$el.data("scope"),i=$.extend(!0,{},n,e);t.$el.data("scope",i)}t.options.functions.open.before(t.$el.data("scope")),t.toggle(t),t.options.functions.open.after(t.$el.data("scope"));var o=.1*$(window).height(),a=t.$el.css("top");a.replace("px",""),a=parseInt(a),a=o+$(document).scrollTop(),t.$el.css("top",a)}})},$.fn.abortModal=function(e){return this.each(function(){var t=$.data(this,"ctrl");if(t&&t.isActive){if(e){var n=t.$el.data("scope"),i=$.extend(!0,{},n,e);t.$el.data("scope",i)}t.options.functions.abort.before(t.$el.data("scope"))&&(t.toggle(t),t.options.functions.abort.after(t.$el.data("scope")))}})},$.fn.completeModal=function(e){return this.each(function(){var t=$.data(this,"ctrl");if(t&&t.isActive){if(e){var n=t.$el.data("scope"),i=$.extend(!0,{},n,e);t.$el.data("scope",i)}t.options.functions.complete.before(t.$el.data("scope"))&&(t.toggle(t),t.options.functions.complete.after(t.$el.data("scope")))}})}}();var EntityEmbed=EntityEmbed||{};!function(){function e(e){var n=this;e||(e={}),n.options=$.extend(!0,{},t,e),n.init()}var t={modalId:"leave-confirmation-modal",viewPath:"modal/modal_confirmation.html",abortElId:"btn-cancel-leave",completeElId:"btn-confirm-leave"};e.prototype.init=function(){var e=this;e.$abortEl=$("#"+e.options.abortElId),e.$completeEl=$("#"+e.options.completeElId)},e.prototype.functions={init:{before:function(e){},after:function(e){}},open:{before:function(e){},after:function(e){}},abort:{before:function(e){return!0},after:function(e){}},complete:{before:function(e){return e.parentModalCtrl.$el.abortModal({confirmedLeave:!0}),!0},after:function(e){}}},EntityEmbed.confirmModalDefaults=e}();var EntityEmbed=EntityEmbed||{};!function(){function e(){}EntityEmbed.embedModalTypes={add:0,addSingle:1,edit:2,selectExisting:3};var t=void 0,n=!1,i={buttons:{saveEmbed:"#btn-save-modal",abortModal:"#btn-abort-modal",showSelectExisting:"#btn-show-select-existing",selectExisting:"#btn-select-existing-embed",cancelSelectExisting:"#btn-cancel-select-existing"},containers:{createNewEmbed:"#embed-modal-create-new",selectExistingEmbed:"#embed-modal-select-existing",createButtons:"#embed-modal-buttons-create",selectButtons:"#embed-modal-buttons-select"},elements:{selectExistingTableBody:".embed-modal-select-existing tbody",selectExistingTableRow:".embed-modal-select-existing-item",selectExistingActiveItem:"embed-modal-active-row",saveSpinner:"#embed-modal-spinner"}},o=function(e,t){return'<tr class="embed-modal-select-existing-item" id="'+t+'"><td>'+e+"</tr></td>"},a=function(e,t){$(".editable").attr("contenteditable",t)},r=function(e){var t=!1;return e.find(":input:not(:button):not([type=hidden])").each(function(){var e=this;if(("text"==e.type||"textarea"==e.type||"hidden"==e.type)&&e.defaultValue!=e.value)return t=!0,!1;if(("radio"==e.type||"checkbox"==e.type)&&e.defaultChecked!=e.checked)return t=!0,!1;if("select-one"==this.type||"select-multiple"==this.type)for(var n=0;n<this.length;n++)if(this.options[n].selected!=this.options[n].defaultSelected)return hasChanges=!0,!1}),t},s=function(e,t){t&&(e.currentEmbedType&&(e.currentEmbedType.$view.hide(),e.currentEmbedType.clearForm(e.currentEmbedType.$view)),e.currentEmbedType=m(t),e.currentEmbedType.$view.show(),e.$embedTypeSelect[0].selectedIndex=e.currentEmbedType.optionIndex)},l=function(e){var t=e.embedTypes[0].options.object_type;s(e,t),e.$embedTypeSelect.show()},d=function(e){var t=e.currentEmbedType.validate(e.currentEmbedType.$view);if(!n&&e.currentEmbedType.$view.find("form").valid()){n=!0,$(i.elements.saveSpinner).show(),e.currentEmbedType.getModelFromForm(e.currentEmbedType.$view);var o=e.modalType==EntityEmbed.embedModalTypes.add||e.modalType==EntityEmbed.embedModalTypes.addSingle;if(o)var a=function(t){return"ERROR"===t.status?void console.log("POST failed"):"string"==typeof t.response?void console.log("Failed to POST embed type: "+t.response):(e.currentEmbedType.model.object_id=t.response.object_id,console.log("POST succeeded"),e.modalCtrl.$el.completeModal(),void(e.successCallback&&e.successCallback(t.response)))},r=function(t){console.log("POST failed"),e.failCallback&&e.failCallback()};else var a=function(t){return"ERROR"===t.status?void console.log("PUT failed"):"string"==typeof t.response?void console.log("Failed to PUT embed type: "+t.response):(console.log("PUT succeeded"),e.modalCtrl.$el.completeModal(),void(e.successCallback&&e.successCallback(t.response)))},r=function(t){console.log("PUT failed"),e.failCallback&&e.failCallback()};var s=function(t){n=!1,$(i.elements.saveSpinner).hide(),e.alwaysCallback&&e.alwaysCallback()};e.currentEmbedType.saveEmbed(o,a,r,s),t.resetForm()}},c=function(e){$(i.elements.selectExistingTableRow).remove(),EntityEmbed.apiService.post({path:e.currentEmbedType.options.httpPaths.getAll,data:{object_type:e.currentEmbedType.options.object_type,auth_token:"abc123"},success:function(t){if("string"==typeof data.response)return void console.log("Failed to get list of current embed types for the Select Existing page.: "+data.response);if(t.response.data){e.selectExistingItems=t.response.data;for(var n=0;n<e.selectExistingItems.length;n++){var a=$(o(e.selectExistingItems[n].title,e.selectExistingItems[n].object_id));$(i.elements.selectExistingTableBody).append(a),e.modalCtrl.registerEvent(a,"click",function(e,t){var n=!$(e.currentTarget).hasClass(i.elements.selectExistingActiveItem);$(i.elements.selectExistingTableBody).find("."+i.elements.selectExistingActiveItem).removeClass(i.elements.selectExistingActiveItem),n?($(e.currentTarget).addClass(i.elements.selectExistingActiveItem),$(i.buttons.selectExisting).removeClass("disabled")):$(i.buttons.selectExisting).addClass("disabled")})}}},fail:function(e){console.log("Failed to get list of current embed types for the Select Existing page.")}})},u=function(e){$(i.buttons.showSelectExisting).show(),e.$embedTypeSelect.show(),$(i.containers.selectExistingEmbed).slideUp(),$(i.containers.createNewEmbed).slideDown(),$(i.containers.selectButtons).hide(),$(i.containers.createButtons).show()},p=function(e){$(i.buttons.showSelectExisting).hide(),e.$embedTypeSelect.hide(),$(i.containers.selectExistingEmbed).is(":visible")&&($(i.containers.selectExistingEmbed).slideUp(),$(i.containers.createNewEmbed).slideDown()),$(i.containers.selectButtons).hide(),$(i.containers.createButtons).show(),$(i.buttons.showSelectExisting).hide()},m=function(e){var n=$.grep(t,function(t){return t.options.object_type==e});return n.length>0?n[0]:null},f=function(e,t){var n='<figure contenteditable="false" id="'+e.model.object_id+'" data-embed-type="'+e.options.object_type+'" >'+e.parseForEditor()+"</figure>";return t?'<div class="entity-embed-container">'+n+"</div>":n};e.prototype.generateEmbedHtml=f,e.prototype.functions={init:{before:function(e){e.currentEmbedType=null,t=e.embedTypes,$(i.elements.saveSpinner).hide()},after:function(e){e.$modalBody.find(i.containers.selectExistingEmbed).load("modal/modal_selectedExisting.html",function(e,t,n){console.log("modal_selectedExisting.html load completed with status: "+t),$(i.buttons.selectExisting).addClass("disabled")});for(var t=0,n=0;n<e.embedTypes.length;n++){var o=e.embedTypes[n];e.$embedTypeSelect.append('<option value="'+o.options.object_type+'">'+o.options.displayName+"</option>"),e.$modalBody.find(i.containers.createNewEmbed).append('<div id="'+o.name+'"></div>');var a=e.$modalBody.find("#"+o.name);a.load(o.options.viewPath,function(e,t,n){console.log(o.options.viewPath+" load completed with status: "+t)}),o.$view=a,o.optionIndex=t,a.hide(),t++}setTimeout(function(){for(var t=0;t<e.embedTypes.length;t++)e.embedTypes[t].initModal(e.embedTypes[t].$view)},200);var r=new EntityEmbed.confirmModalDefaults;i.elements.confirmModal="#"+r.options.modalId,$("#"+r.options.modalId).load(r.options.viewPath,function(t,n,i){if(console.log("leave confirmation modal load completed with status: "+n),"error"!==n){var o={parentModalCtrl:e.modalCtrl};r.init(),$("#"+r.options.modalId).modal(r,o)}}),e.modalCtrl.registerEvent(e.$embedTypeSelect,"change",function(e,t){t.currentEmbedType.clearForm(t.currentEmbedType.$view);var n=e.currentTarget.options[e.currentTarget.selectedIndex].value;s(t,n),t.modalType===EntityEmbed.embedModalTypes.selectExisting&&c(t)}),e.modalCtrl.registerEvent(i.buttons.saveEmbed,"click",function(e,t){d(t)}),e.modalCtrl.registerEvent(i.buttons.showSelectExisting,"click",function(e,t){t.modalType=EntityEmbed.embedModalTypes.selectExisting,c(t),$(i.containers.createNewEmbed).slideUp(),$(i.containers.selectExistingEmbed).slideDown(),$(i.containers.createButtons).hide(),$(i.containers.selectButtons).show()}),e.modalCtrl.registerEvent(i.buttons.cancelSelectExisting,"click",function(e,t){t.modalType=EntityEmbed.embedModalTypes.add,u(t)}),e.modalCtrl.registerEvent(i.buttons.selectExisting,"click",function(e,t){$(i.buttons.selectExisting).hasClass("disabled")||EntityEmbed.apiService.get({path:t.currentEmbedType.options.httpPaths.get,data:{object_id:$("."+i.elements.selectExistingActiveItem).attr("id"),auth_token:"abc123"},success:function(e){return"string"==typeof e.response?void console.log("Failed to get list of current embed types for the Select Existing page.: "+e.response):(t.currentEmbedType.model=e.response,void t.modalCtrl.$el.completeModal())},fail:function(e){console.log("failed to get embed type!")}})})}},open:{before:function(e){a(e,"false"),e.embedType?(s(e,e.embedType),delete e.embedType):l(e)},after:function(e){e.modalType==EntityEmbed.embedModalTypes.edit?(p(e),EntityEmbed.apiService.get({path:e.currentEmbedType.options.httpPaths.get,data:{object_id:e.embedId,auth_token:"abc123"},success:function(t){return"string"==typeof t.response?void console.log("Failed to get embed type: "+t.response):(s(e,t.response.object_type),e.currentEmbedType.model=t.response,e.staleModel=$.extend(!0,{},t.response),void e.currentEmbedType.populateFormWithModel(e.currentEmbedType.$view))},fail:function(e){console.log("failed to get embed type!")}})):e.modalType==EntityEmbed.embedModalTypes.add?u(e):e.modalType==EntityEmbed.embedModalTypes.addSingle&&(u(e),e.$embedTypeSelect.hide())}},abort:{before:function(e){if(!e.confirmedLeave)if(e.modalType===EntityEmbed.embedModalTypes.edit&&e.staleModel){e.currentEmbedType.getModelFromForm(e.currentEmbedType.$view);for(var t in e.currentEmbedType.model)if(!e.staleModel[t]||e.staleModel[t]!==e.currentEmbedType.model[t])return $(i.elements.confirmModal).openModal(),!1}else if(r(e.currentEmbedType.$view))return $(i.elements.confirmModal).openModal(),!1;var n=e.currentEmbedType.validate(e.currentEmbedType.$view);return n.resetForm(),delete e.confirmedLeave,!0},after:function(e){a(e,"true")}},complete:{before:function(e){return!0},after:function(e){if(a(e,"true"),e.$currentEditorLocation.length>0){e.$currentEditorLocation.addClass("entity-embed-editor-line");var t=e.$currentEditorLocation.html(f(e.currentEmbedType,!0)),n=jQuery.Event("entityEmbedAdded");n.embedType=e.currentEmbedType,t.find(".entity-embed-container").trigger(n)}}}},$.fn.embed_modal_open=function(e){var t={$currEditorLocation:$(""),embedTypeStr:null,id:null,successCallback:function(e){},failCallback:function(){},alwaysCallback:function(){}};e=$.extend(!0,{},t,e);var n;n=e.id?EntityEmbed.embedModalTypes.edit:e.embedTypeStr?EntityEmbed.embedModalTypes.addSingle:EntityEmbed.embedModalTypes.add;var i={$currentEditorLocation:e.$currEditorLocation,modalType:n,embedId:e.id,embedType:e.embedTypeStr,successCallback:e.successCallback,failCallback:e.failCallback,alwaysCallback:e.alwaysCallback};this.openModal(i)},EntityEmbed.embedModalDefaults=e}(),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="audio",o={viewPath:e+"modal/modal_audio.html",displayName:"Audio",object_type:"audio",validationOptions:{debug:!0,rules:{title:"required",url:"required",mp3File:{required:!0,extension:"mp3"},wavFile:{extension:"wav"}}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=3,n.prototype.cleanModel=function(){return{title:null,file:[],credit:null,creditLink:null}},n.prototype.initModal=function(e){var t=this;e.find(".audio-file-group").fileupload({dataType:"json",replaceFileInput:!1,add:function(e,n){n.submit().complete(function(e,n,i){"success"===n?e&&e.responseJSON&&e.responseJSON.path&&(t.model.file=e.responseJSON.path):(console.log('file upload completed with status "'+n+'"'),console.log(e))})}})},n.prototype.parseForEditor=function(){var e=this,t=e.model.file.substring(e.model.file.lastIndexOf(".")+1);return'<div class="audio-embed"><audio controls><source src="'+e.model.file+'" type="audio/'+t+'"></audio><div class="credit">Credit: '+e.model.credit+'</div><div class="link">Link: '+e.model.creditLink+"</div></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,a,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="customText",o="custom-text-editor",a={viewPath:e+"modal/modal_customText.html",displayName:"Custom Text",object_type:"custom",validationOptions:{rules:{title:"required",customText:"required"}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=5,n.prototype.getModelFromForm=function(e){for(var t=this,n=e.find(".embed-modal-form-control"),i=0;i<n.length;i++){var a,r;n[i].id==o?(a=n[i].attributes.name.nodeValue,r=n[i].innerHTML):(a=n[i].name,r=n[i].value),a&&r&&(t.model[a]=r)}},n.prototype.cleanModel=function(){return{title:null,displayTitle:null,text:null}},n.prototype.clearForm=function(e,t){var t=this;t.parent.clearForm(e,t);for(var n=e.find(".embed-modal-form-control"),i=0;i<n.length;i++)n[i].type&&-1!==n[i].type.indexOf("select")?n[i].selectedIndex=0:(n[i].value=null,n[i].innerHTML="");t.model=t.cleanModel()},n.prototype.populateFormWithModel=function(e){for(var t=this,n=e.find(".embed-modal-form-control"),i=0;i<n.length;i++)if(n.type&&-1!==n[i].type.indexOf("select")){var a=$(n[i]).find("option"),r=t.model[n[i].name],s=0;a.each(function(e){this.value===r&&(s=e)}),n[i].selectedIndex=s}else n[i].value=t.model[n[i].name],n[i].id==o&&(n[i].innerHTML=t.model[n[i].attributes.name.nodeValue])},n.prototype.initModal=function(e){new MediumEditor("#"+o)},n.prototype.parseForEditor=function(){var e=this;return'<div class="custom-text-embed"><div class="display-title">'+e.model.displayTitle+'</div><div class="custom-text">'+e.model.customText+"</div></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="externalLink",o={viewPath:e+"modal/modal_externalLink.html",displayName:"External Link",object_type:"external-link",validationOptions:{rules:{title:"required",url:"required",linkText:"required"}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=9,n.prototype.cleanModel=function(){return{thumbnailFile:null,title:null,displayTitle:null,teaser:null,linkText:null,url:null}},n.prototype.initModal=function(e){var t=this;e.find("input[name='thumbnailFile']").fileupload({dataType:"json",replaceFileInput:!1,add:function(e,n){n.submit().complete(function(e,n,i){"success"===n?e&&e.responseJSON&&e.responseJSON.path&&(t.model.thumbnailFile=e.responseJSON.path):(console.log('file upload completed with status "'+n+'"'),console.log(e))})}})},n.prototype.parseForEditor=function(){var e=this;return'<div class="external-link-embed entity-embed-secondary-toolbar-locator"><div class="display-title">'+e.model.displayTitle+'</div><div class="teaser">'+e.model.teaser+'</div><a class="btn btn-primary external-link" href="'+e.model.url+'">'+e.model.linkText+"</a></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="facebook",o={viewPath:e+"modal/modal_facebook.html",displayName:"Facebook",object_type:"facebook",validationOptions:{rules:{title:"required",url:"required"}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=7,n.prototype.getModelFromForm=function(e){for(var t=this,n=e.find(".embed-modal-form-control"),i=0;i<n.length;i++){var o=n[i].name,a=n[i].value;o&&a&&(t.model[o]=a)}var r="embedCode",s='<script>(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) return;js = d.createElement(s);js.id = id;js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";fjs.parentNode.insertBefore(js, fjs);}(document, "script", "facebook-jssdk"));</script><div class="fb-post" data-href="'+this.model.url+'" data-width="500"></div>';t.model[r]=s},n.prototype.cleanModel=function(){return{title:null,url:null}},n.prototype.parseForEditor=function(){var e=this;return'<div class="facebook-embed"><div class="facebook-info"><span>click here to show the toolbars</span></div><div class="overlay">'+e.model.embedCode+'</div><div class="facebook-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="globalBuzz",o={viewPath:e+"modal/modal_globalBuzz.html",displayName:"Global Buzz",object_type:"global-buzz",validationOptions:{rules:{title:"required",quote:"required",url:"required"}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=13,n.prototype.cleanModel=function(){return{title:null,quote:null,credit:null,quoteUrl:null}},n.prototype.parseForEditor=function(){var e=this;return'<div class="global-buzz"><article class="global-buzz-quote-wrapper engagement-badge-wrapper"><div class="engagement-badge"></div><div><h1 class="global-buzz-teaser">Global Buzz</h1><div class="buzz-field-quote"><img class ="buzz-field-quote-png" src="http://www.pri.org/sites/all/themes/pri/images/icon-open-quote.png"><div class="buzz-quote-inner">'+e.model.quote+'</div></div><div class="buzz-field-quote-credit">'+e.model.credit+'</div><a class="btn btn-primary global-buzz-link" href="'+e.model.quoteUrl+'">'+e.model.quoteUrlText+"</a></div></div></article></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="iframe",o={viewPath:e+"modal/modal_iframe.html",displayName:"iFrame",object_type:"iframe",validationOptions:{rules:{title:"required",url:"required"}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=11,n.prototype.cleanModel=function(){return{title:null,url:null,allowsScroll:!1}},n.prototype.parseForEditor=function(){return'<div class="iframe-embed"><div class="iframe-info"><span>click here to show the toolbars</span></div><iframe src="'+this.model.url+'" frameborder="0" scrolling="'+this.model.allowsScroll+'"></iframe><div class="iframe-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes);var EntityEmbed=EntityEmbed||{};!function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="image",o={viewPath:e+"modal/modal_image.html",displayName:"Image(s)",object_type:"image",validationOptions:{rules:{title:"required",altText:"required",license:"required",imageFile:{required:!0,extension:"png|jpg|jpeg|gif"}}},httpPaths:{getLicenses:"https://test-services.pri.org/admin/image-license/list"}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=1,n.prototype.cleanModel=function(){return{file:null,title:null,altText:null,credit:null,creditLink:null,caption:null,license:null}},n.prototype.loadLicenses=function(e){var t=this,n="<option disabled selected>-- select a license --</option>";EntityEmbed.apiService.get({path:t.options.httpPaths.getLicenses,data:{auth_token:"abc123"},success:function(t){if(t.response.data){var i=[];i.push(n);for(var o=0;o<t.response.data.length;o++)i.push('<option value="'+t.response.data[o].license+'">'+t.response.data[o].title+"</option>");e.find('[name="license"]').html(i)}},fail:function(e){console.log("failed to find load image license options")}})},n.prototype.initModal=function(e){var t=this;t.loadLicenses(e),e.find('input[name="imageFile"]').fileupload({dataType:"json",replaceFileInput:!1,add:function(e,n){n.submit().complete(function(e,n,i){"success"===n?e&&e.responseJSON&&e.responseJSON.path&&(t.model.file=e.responseJSON.path):(console.log('file upload completed with status "'+n+'"'),console.log(e))})}})},n.prototype.parseForEditor=function(){var e=this;return'<div class="images-embed"><img class="entity-embed-secondary-toolbar-locator" src="'+e.model.file+'" /><div class="images-embed-caption">'+e.model.caption+'</div><div class="images-embed-credit">Credit: '+e.model.credit+"</div></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="instagram",o={viewPath:e+"modal/modal_instagram.html",displayName:"Instagram",object_type:"instagram",validationOptions:{rules:{title:"required",url:"required"}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=8,n.prototype.getModelFromForm=function(e){for(var t=this,n=e.find(".embed-modal-form-control"),i=0;i<n.length;i++){var o=n[i].name,a=n[i].value;o&&a&&(t.model[o]=a)}var r="embedCode",s='<blockquote class="instagram-media" data-instgrm-captioned data-instgrm-version="6" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: auto; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px); "><a href="'+t.model.url+'" style=" color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;" target="_blank"></a></blockquote><script async defer src="//platform.instagram.com/en_US/embeds.js"></script>';t.model[r]=s},n.prototype.cleanModel=function(){return{title:null,url:null}},n.prototype.parseForEditor=function(){var e=this;return'<div class="instagram-embed"><div class="instagram-info"><span>click here to show the toolbars</span></div><div class="overlay">'+e.model.embedCode+'</div><div class="instagram-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes);var EntityEmbed=EntityEmbed||{};!function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="newsletterSubscribe",o={viewPath:e+"modal/modal_newsletterSubscribe.html",displayName:"Newsletter Subscribe",object_type:"newsletter",
validationOptions:{rules:{title:"required",newsletter:"required"}},httpPaths:{getNewsletters:"https://test-services.pri.org/admin/newsletter/list"}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=12,n.prototype.cleanModel=function(){return{title:null,displayTitle:null,newsletterId:null,teaser:null}},n.prototype.initModal=function(e){var t=this,n="<option disabled selected>-- select a newsletter --</option>";EntityEmbed.apiService.get({path:t.options.httpPaths.getNewsletters,data:{auth_token:"abc123"},success:function(t){if(t.response.data){var i=[];i.push(n);for(var o=0;o<t.response.data.length;o++)i.push('<option value="'+t.response.data[o].newsletter_id+'" >'+t.response.data[o].title+"</option>");e.find('[name="newsletter"]').html(i)}},fail:function(){console.log("failed to load newsletter subscription options")}})},n.prototype.parseForEditor=function(){var e=this;return'<div class="newsletter-subscribe-embed entity-embed-secondary-toolbar-locator"><div class="display-title">'+e.model.displayTitle+'</div><div class="subscribe-form"><div class="teaser">'+e.model.teaser+'</div><div class="embed-modal-form"><input name="email" type="text" placeholder="user@domain.com" class="embed-modal-form-control"></div><button class="btn btn-primary subscribe-btn">Subscribe</button>'}}("",EntityEmbedTypes);var EntityEmbed=EntityEmbed||{};!function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="relatedLink",o={viewPath:e+"modal/modal_relatedLink.html",displayName:"Related Link",object_type:"related-link",validationOptions:{rules:{title:"required"}}},a=[],r=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=10,n.prototype.cleanModel=function(){return{title:null,displayTitle:null,links:[]}};var s=function(e,t){EntityEmbed.apiService.get({path:t.options.httpPaths.get,data:{object_id:"dbbc5fc38d2e4d359572743d2c00d581",auth_token:"abc123"},success:function(t){var n={data:t.response.stories,getValue:"Title",list:{maxNumberOfElements:10,match:{enabled:!0},sort:{enabled:!0}}};$(e).easyAutocomplete(n),$(e).focus()},fail:function(e){console.log("failed to retrieve any stories!")}})};n.prototype.getModelFromForm=function(e){for(var t=this,n=e.find(".embed-modal-form-control"),i=0;2>i;i++){var o=n[i].name,r=n[i].value;o&&r&&(t.model[o]=r)}for(var i=0;i<a.length;i++){var s=e.find("#"+a[i]);t.model.links.push(s[0].value)}},n.prototype.populateFormWithModel=function(e){var t=this;t.parent.populateFormWithModel(e);for(var n="related-link-url",i=(e.find("#related-link-list"),e.find("#add-link-btn")),o=0;o<t.model.links.length;o++)i.click(),e.find("."+n).last().val(t.model.links[o])},n.prototype.initModal=function(e){var t=this,n="related-link-url",i="remove-link-btn",o=e.find("#related-link-list"),l=e.find("#add-link-btn");l.click(function(){var e=r();a.push(e),o.append('<div class="'+n+'"><div class="embed-modal-form"><input id="'+e+'" type="url" placeholder="link url" class="embed-modal-form-control" required></div><button class="'+i+'"><i class="fa fa-minus"></i></button></div>'),$("#"+e).keydown(function(){$("#"+e).keydown(s("#"+e,t))})}),e.on("click","."+i,function(){$(document.activeElement).closest("."+n).remove()})},n.prototype.parseForEditor=function(){var e=this;return'<div class="relatedLink-embed"><p class="relatedLink-embed-uiText"> <strong>Embed Type:</strong> Related Link </p><p  class="relatedLink-embed-uiText"> <strong>Title:</strong> '+e.model.title+"</p></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,a,o,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i,o="slideshow",a={viewPath:e+"modal/modal_slideshow.html",displayName:"Slideshow",object_type:"slideshow",validationOptions:{rules:{slideshowTitle:"required",title:"required",altText:"required",license:"required"}}},r=function(){for(var e="",t=0;8>t;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e},s="#embed-modal-slideshow-image",l=".embed-modal-slideshow-image-select",d={},c=function(){var e=$(s).find("legend").attr("data-image-id");i.getModelFromForm($(s)),d[e]=i.model},u=function(e){var t=$("#"+e),n=$(s).find("legend").attr("data-image-id");n&&""!==n?(c(),i.clearForm($(s)),i.model=d[e],i.populateFormWithModel($(s))):($(s).show(),$(l).show()),$(s).find("legend").attr("data-image-id",e),$(l).val(t.val())};n.inherits(t.genericEmbed),t[o]=n,n.prototype.orderIndex=2,n.prototype.cleanModel=function(){return{title:null,images:[]}},n.prototype.initModal=function(e){var t=this;t.model=t.cleanModel(),i=$.grep(EntityEmbed.embedTypes,function(e){return"image"==e.name})[0],i.loadLicenses(e),e.find("input[name='imageFile']").fileupload({dataType:"json",replaceFileInput:!1,add:function(t,n){n.submit().complete(function(t,o,a){if("success"===o){if(!t||!t.responseJSON||!t.responseJSON.path)return console.log('file upload completed with status "'+o+'"'),void console.log(t);var s=r();d[s]=i.cleanModel();var c=0;for(var p in d)c+=1;var m=$('<option id="'+s+'">image '+c+"</option>");n.context=m.appendTo(e.find(l)),u(s)}})}}),e.on("change",l,function(e){var t=$(e.currentTarget.options[e.currentTarget.selectedIndex]);u(t.attr("id"))})},n.prototype.saveEmbed=function(e,t,n){for(var o=this,a=[],r=0;r<o.model.images.length;r++){i.model=o.model.images[r],i.model.order=r;var s=!i.model.object_id;a.push(i.saveEmbed(s,function(e){"ERROR"==e.status&&console.log("failed to put/post a slideshow image"),o.model.images[e.response.order]={object_id:e.response.object_id}},function(){console.log("failed to put/post a slideshow image")})),$.when.apply($,a).done(function(){return e?(o.model.object_type=o.options.object_type,EntityEmbed.apiService.post({path:o.options.httpPaths.post,data:o.model,success:t,fail:n})):EntityEmbed.apiService.put({path:o.options.httpPaths.put,data:o.model,success:t,fail:n})})}},n.prototype.getModelFromForm=function(e){var t=this;c(),t.model.title=e.find("input[name=slideshowTitle]").val(),t.model.images=[];for(var n in d)t.model.images.push(d[n])},n.prototype.clearForm=function(e){var t=this;t.parent.clearForm(e),e.find(l).children().remove(),$(s).hide(),$(l).hide(),e.find("legend").attr("data-image-id","")}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="twitter",o={viewPath:e+"modal/modal_twitter.html",displayName:"Twitter",object_type:"twitter",validationOptions:{rules:{title:"required",url:"required"}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=6,n.prototype.getModelFromForm=function(e){for(var t=this,n=e.find(".embed-modal-form-control"),i=0;i<n.length;i++){var o=n[i].name,a=n[i].value;o&&a&&(t.model[o]=a)}var r="embedCode",s='<blockquote class="twitter-tweet" data-lang="en" style="width:50%; margin:auto;"><a href="'+t.model.url+'"></a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>';t.model[r]=s},n.prototype.cleanModel=function(){return{title:null,url:null}},n.prototype.parseForEditor=function(){var e=this;return'<div class="twitter-embed"><div class="twitter-info"><span>click here to show the toolbars</span></div><div class="overlay">'+e.model.embedCode+'</div><div class="twitter-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes),function(e,t){"use strict";function n(e){var t=this;t.parent.constructor(e,o,i,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var i="video",o={viewPath:e+"modal/modal_video.html",displayName:"Video",object_type:"video",validationOptions:{rules:{title:"required",url:"required"}}};n.inherits(t.genericEmbed),t[i]=n,n.prototype.orderIndex=4,n.prototype.cleanModel=function(){return{title:null,url:null}},n.prototype.parseForEditor=function(){var e=this;return $.support.cors=!0,$.ajax({crossDomain:!0,cache:!1,async:!1,timeout:15e3,url:"http://medium.iframe.ly/api/oembed?iframe=1",dataType:"json",data:{url:e.model.url},success:function(t){e.model.videoHtmlString=$(t.html).find("iframe").attr("style","").prop("outerHTML")},error:function(e,t,n){}}),'<div class="video-embed"><div class="video-info"><span>click here to show the toolbars</span></div><div class="overlay"></div>'+e.model.videoHtmlString+'<div class="video-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes);var EntityEmbed=EntityEmbed||{};!function(e,t,n,i,o){"use strict";function a(e){var t,n,i="[[",o="]]";return n=[l,e.index,e.id].join(":"),t=[i,n,o].join("")}function r(n,i){var o=this;o.el=n,o.$el=e(n),o.templates=t.MediumInsert.Templates,f(),o.core=o.$el.data("plugin_"+s),o.options=e.extend(!0,{},m,i),o._defaults=m,o._name=s,o.toolbarManager=new EntityEmbed.toolbarManager(o,o.options.styles,o.options.actions,d),o.core.getEditor()&&(o.core.getEditor().get_content=function(){return o.getContent()},o.core.getEditor().load_content=function(e){o.loadContent(e)}),o.init()}var s="mediumInsert",l="EntityEmbeds",d="entity-embed-active",c=".medium-insert-active",u="embed-modal-btn-open",d="entity-embed-active",p="entity-embed-container",m={label:'<span class="fa fa-code"></span>',modalOptions:{},modalScope:{$embedTypeSelect:null,$modalBody:null},$modalEl:null,insertBtn:".medium-insert-buttons-show",fileUploadOptions:{url:"upload.php",acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},styles:{left:{label:'<span class="fa fa-align-left"></span>',added:function(e){e.addClass("clearfix")},removed:function(e){e.removeClass("clearfix")}},center:{label:'<span class="fa fa-align-center"></span>'},right:{label:'<span class="fa fa-align-right"></span>',added:function(e){e.addClass("clearfix")},removed:function(e){e.removeClass("clearfix")}},wide:{label:'<span class="fa fa-align-justify"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e,t){e.removeEmbed(t)}},edit:{label:'<span class="fa fa-cog"></span>',clicked:function(e,t){e.editEmbed(t)}},newline:{label:'<span class="fa fa-i-cursor"></span>',clicked:function(e,t){e.addNewline(t)}}},embedTypes:{image:{},slideshow:{},video:{},audio:{},twitter:{},instagram:{},facebook:{},relatedLink:{},externalLink:{},globalBuzz:{},newsletterSubscribe:{},iframe:{},customText:{}}},f=function(){m.$modalEl||(m.$modalEl=e("#embed-modal")),m.modalScope.$embedTypeSelect||(m.modalScope.$embedTypeSelect=e("#select-embed-type")),m.modalScope.$modalBody||(m.modalScope.$modalBody=e(".embed-modal-body")),m.modalOptions.$abortEl||(m.modalOptions.$abortEl=e("#btn-abort-modal"))};r.prototype.init=function(){var t=this;t.toolbarManager.createActionToolbar(e("body")),t.events(),t.embedTypes=[];for(var n in i)if(t.options.embedTypes[n]){var o=new i[n](t.options.embedTypes[n]);t.embedTypes.push(o),t.toolbarManager.createStyleToolbar(e("body"),o)}t.embedTypes.sort(function(e,t){return e.orderIndex-t.orderIndex}),EntityEmbed.embedTypes=t.embedTypes,t.finalModalOptions={};var a=new EntityEmbed.embedModalDefaults;t.options.modalOptions?t.finalModalOptions=e.extend(!0,{},a,t.options.modalOptions):t.finalModalOptions=a;var r={embedTypes:t.embedTypes};r=e.extend(!0,{},t.options.modalScope,r),t.options.$modalEl.modal(t.finalModalOptions,r)},r.prototype.events=function(){var i,o=this;i=t.setInterval(function(){var n,a=o.$el.find(o.options.insertBtn);a.length&&(t.clearInterval(i),n=e("<a>+</a>").addClass(u).on("click",function(){o.add()}).insertAfter(a),a.hide())},100),e(n).on("click",function(t){e(t.target).is(".medium-editor-action")||e(t.target.parentElement).is(".medium-editor-action")||0==o.$el.find("."+d).length||(e("."+d).removeClass(d),o.toolbarManager.hideToolbar())}).on("click","."+p,function(t){o.toggleSelectEmbed(e(this)),t.stopPropagation()}).on("keydown",".editable.editor",function(t){if(8==t.which||46==t.which){var n=e(".editable.editor p").length;if(1>=n){var i=e(".editable.editor p").text();i&&""!==i||t.preventDefault()}}}).on("keydown",function(e){8!=e.which&&46!=e.which||0!=o.$el.find("."+d).length&&o.toolbarManager.hideToolbar()}).on("entityEmbedAdded","."+p,function(t){o.addEmbed(e(this),t.embedType)})},r.prototype.getCore=function(){return this.core},r.prototype.getContent=function(){var t=this,n=t.core.getEditor().serialize(),i={html:"",embeds:[]};return e.each(n,function(t){var o,r;o=e("<div />").html(n[t].value),r=o.find(".entity-embed-container",o),r.each(function(t){var n,o,r,s;n=e(this),o=n.find("figure"),o&&(r={index:t,id:o.attr("id"),style:o.attr("class"),type:o.attr("data-embed-type")},i.embeds.push(r),s=a(r),n.html(s))}),i.html+=o.html()}),i},r.prototype.loadContent=function(t){function n(t){var n;if(!t)return void i();if(o=t.html||"",!t.embeds)return void i();n=[];for(var s=0;s<t.embeds.length;s++)t.embeds[s].embedType=e.grep(r.embedTypes,function(e){return e.options.object_type==t.embeds[s].type})[0],t.embeds[s].embedType.model=t.embeds[s].embedType.cleanModel(),n.push(EntityEmbed.apiService.get({path:t.embeds[s].embedType.options.httpPaths.get,data:{object_id:t.embeds[s].id},success:function(e){return function(t){var n,i;"ERROR"===t.status&&console.log("failed to get embed object!"),e.embedType.model=t.response,n=r.finalModalOptions.generateEmbedHtml(e.embedType,!1),i=a(e),o=o.split(i).join(n)}}(t.embeds[s])}));e.when.apply(e,n).done(function(){i()})}function i(){r.core.getEditor().setContent(o)}var o,r=this,s="string"==typeof t,l=s&&/<[^>]>/g.test(t);return t?(o=s?l?t:"":t.html,void(s&&!l?EntityEmbed.apiService.get({path:"https://test-services.pri.org/admin/embed/edit",data:{object_id:t},sucess:function(e){return"ERROR"===e.status?void console.log("Failed to get story with id "+t):void n(e.repsonse)},fail:function(e){console.log("Failed to get story with id "+t)}}):n(t))):void console.log("Must provide either story id or serialived story data.")},r.prototype.add=function(){var t=this,n={$currentEditorLocation:e(c),modalType:EntityEmbed.embedModalTypes.add};t.options.$modalEl.openModal(n)},r.prototype.editEmbed=function(t){var n=this,i={$currentEditorLocation:e("."+d),modalType:EntityEmbed.embedModalTypes.edit,embedId:t.find("figure").attr("id"),embedType:t.find("[data-embed-type]").attr("data-embed-type")};n.toolbarManager.hideToolbar(),n.options.$modalEl.openModal(i)},r.prototype.removeEmbed=function(e){var t=this;t.toolbarManager.hideToolbar(),e.remove()},r.prototype.addNewline=function(e){var t=this,n='<p class="entity-embed-new-line">&nbsp</p>';e.before(n),e.after(n),t.toolbarManager.positionToolbars(e)},r.prototype.toggleSelectEmbed=function(t){var n=this,i=e("."+d),o=t.find("[data-embed-type]").attr("data-embed-type"),a=e.grep(n.embedTypes,function(e){return e.options.object_type===o})[0].name;n.toolbarManager.hideToolbar(),i.toggleClass(d),t.toggleClass(d),n.options.actions&&(t.hasClass(d)?n.toolbarManager.showToolbars(t,a):n.toolbarManager.hideToolbar())},r.prototype.addEmbed=function(e,t){var n=this,i=t.defaultStyle.replace("entity-embed-","");n.toolbarManager.addStyle(e,t.defaultStyle,i,!1)},e.fn[s+l]=function(t){return this.each(function(){e.data(this,"plugin_"+s+l)||e.data(this,"plugin_"+s+l,new r(this,t))})}}(jQuery,window,document,EntityEmbedTypes),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){e.extend(e.fn,{validate:function(t){if(!this.length)return void(t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var n=e.data(this[0],"validator");return n?n:(this.attr("novalidate","novalidate"),n=new e.validator(t,this[0]),e.data(this[0],"validator",n),n.settings.onsubmit&&(this.on("click.validate",":submit",function(t){n.settings.submitHandler&&(n.submitButton=t.target),e(this).hasClass("cancel")&&(n.cancelSubmit=!0),void 0!==e(this).attr("formnovalidate")&&(n.cancelSubmit=!0)}),this.on("submit.validate",function(t){function i(){var i,o;return n.settings.submitHandler?(n.submitButton&&(i=e("<input type='hidden'/>").attr("name",n.submitButton.name).val(e(n.submitButton).val()).appendTo(n.currentForm)),o=n.settings.submitHandler.call(n,n.currentForm,t),n.submitButton&&i.remove(),void 0!==o?o:!1):!0}return n.settings.debug&&t.preventDefault(),n.cancelSubmit?(n.cancelSubmit=!1,i()):n.form()?n.pendingRequest?(n.formSubmitted=!0,!1):i():(n.focusInvalid(),!1)})),n)},valid:function(){var t,n,i;return e(this[0]).is("form")?t=this.validate().form():(i=[],t=!0,n=e(this[0].form).validate(),this.each(function(){t=n.element(this)&&t,t||(i=i.concat(n.errorList))}),n.errorList=i),t},rules:function(t,n){if(this.length){var i,o,a,r,s,l,d=this[0];if(t)switch(i=e.data(d.form,"validator").settings,o=i.rules,a=e.validator.staticRules(d),t){case"add":e.extend(a,e.validator.normalizeRule(n)),delete a.messages,o[d.name]=a,n.messages&&(i.messages[d.name]=e.extend(i.messages[d.name],n.messages));break;case"remove":return n?(l={},e.each(n.split(/\s/),function(t,n){l[n]=a[n],delete a[n],"required"===n&&e(d).removeAttr("aria-required")}),l):(delete o[d.name],a)}return r=e.validator.normalizeRules(e.extend({},e.validator.classRules(d),e.validator.attributeRules(d),e.validator.dataRules(d),e.validator.staticRules(d)),d),r.required&&(s=r.required,delete r.required,r=e.extend({required:s},r),e(d).attr("aria-required","true")),r.remote&&(s=r.remote,delete r.remote,r=e.extend(r,{remote:s})),r}}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+e(t).val())},filled:function(t){var n=e(t).val();return null!==n&&!!e.trim(""+n)},unchecked:function(t){return!e(t).prop("checked")}}),e.validator=function(t,n){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=n,this.init()},e.validator.format=function(t,n){return 1===arguments.length?function(){var n=e.makeArray(arguments);return n.unshift(t),e.validator.format.apply(this,n)}:void 0===n?t:(arguments.length>2&&n.constructor!==Array&&(n=e.makeArray(arguments).slice(1)),n.constructor!==Array&&(n=[n]),e.each(n,function(e,n){t=t.replace(new RegExp("\\{"+e+"\\}","g"),function(){return n})}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(e)))},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(t,n){var i=[16,17,18,20,35,36,37,38,39,40,45,144,225];9===n.which&&""===this.elementValue(t)||-1!==e.inArray(n.keyCode,i)||(t.name in this.submitted||t.name in this.invalid)&&this.element(t)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,n,i){"radio"===t.type?this.findByName(t.name).addClass(n).removeClass(i):e(t).addClass(n).removeClass(i)},unhighlight:function(t,n,i){"radio"===t.type?this.findByName(t.name).removeClass(n).addClass(i):e(t).removeClass(n).addClass(i)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}."),step:e.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){function t(t){var n=e.data(this.form,"validator"),i="on"+t.type.replace(/^validate/,""),o=n.settings;o[i]&&!e(this).is(o.ignore)&&o[i].call(n,this,t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var n,i=this.groups={};e.each(this.settings.groups,function(t,n){"string"==typeof n&&(n=n.split(/\s/)),e.each(n,function(e,n){i[n]=t})}),n=this.settings.rules,e.each(n,function(t,i){n[t]=e.validator.normalizeRule(i)}),e(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable]",t).on("click.validate","select, option, [type='radio'], [type='checkbox']",t),this.settings.invalidHandler&&e(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler),e(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){var n,i,o=this.clean(t),a=this.validationTargetFor(o),r=this,s=!0;return void 0===a?delete this.invalid[o.name]:(this.prepareElement(a),this.currentElements=e(a),i=this.groups[a.name],i&&e.each(this.groups,function(e,t){t===i&&e!==a.name&&(o=r.validationTargetFor(r.clean(r.findByName(e))),o&&o.name in r.invalid&&(r.currentElements.push(o),s=s&&r.check(o)))}),n=this.check(a)!==!1,s=s&&n,n?this.invalid[a.name]=!1:this.invalid[a.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e(t).attr("aria-invalid",!n)),s},showErrors:function(t){if(t){var n=this;e.extend(this.errorMap,t),this.errorList=e.map(this.errorMap,function(e,t){return{message:e,element:n.findByName(t)[0]}}),this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var t=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(t)},resetElements:function(e){var t;if(this.settings.unhighlight)for(t=0;e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,""),this.findByName(e[t].name).removeClass(this.settings.validClass);else e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t,n=0;for(t in e)e[t]&&n++;return n},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(e){e.not(this.containers).text(""),this.addWrapper(e).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&1===e.grep(this.errorList,function(e){return e.element.name===t.name}).length&&t},elements:function(){var t=this,n={};return e(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var i=this.name||e(this).attr("name");return!i&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.hasAttribute("contenteditable")&&(this.form=e(this).closest("form")[0]),i in n||!t.objectLength(e(this).rules())?!1:(n[i]=!0,!0)})},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.split(" ").join(".");return e(this.settings.errorElement+"."+t,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([])},reset:function(){this.resetInternals(),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var n,i,o=e(t),a=t.type;return"radio"===a||"checkbox"===a?this.findByName(t.name).filter(":checked").val():"number"===a&&"undefined"!=typeof t.validity?t.validity.badInput?"NaN":o.val():(n=t.hasAttribute("contenteditable")?o.text():o.val(),"file"===a?"C:\\fakepath\\"===n.substr(0,12)?n.substr(12):(i=n.lastIndexOf("/"),i>=0?n.substr(i+1):(i=n.lastIndexOf("\\"),i>=0?n.substr(i+1):n)):"string"==typeof n?n.replace(/\r/g,""):n)},check:function(t){t=this.validationTargetFor(this.clean(t));var n,i,o,a=e(t).rules(),r=e.map(a,function(e,t){return t}).length,s=!1,l=this.elementValue(t);if("function"==typeof a.normalizer){if(l=a.normalizer.call(t,l),"string"!=typeof l)throw new TypeError("The normalizer should return a string value.");delete a.normalizer}for(i in a){o={method:i,parameters:a[i]};try{if(n=e.validator.methods[i].call(this,l,t,o.parameters),"dependency-mismatch"===n&&1===r){s=!0;continue}if(s=!1,"pending"===n)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!n)return this.formatAndAdd(t,o),!1}catch(d){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+o.method+"' method.",d),d instanceof TypeError&&(d.message+=".  Exception occurred when checking element "+t.id+", check the '"+o.method+"' method."),d}}if(!s)return this.objectLength(a)&&this.successList.push(t),!0},customDataMessage:function(t,n){return e(t).data("msg"+n.charAt(0).toUpperCase()+n.substring(1).toLowerCase())||e(t).data("msg")},customMessage:function(e,t){var n=this.settings.messages[e];return n&&(n.constructor===String?n:n[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,n){var i=this.findDefined(this.customMessage(t.name,n.method),this.customDataMessage(t,n.method),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[n.method],"<strong>Warning: No message defined for "+t.name+"</strong>"),o=/\$?\{(\d+)\}/g;return"function"==typeof i?i=i.call(this,n.parameters,t):o.test(i)&&(i=e.validator.format(i.replace(o,"{$1}"),n.parameters)),i},formatAndAdd:function(e,t){var n=this.defaultMessage(e,t);this.errorList.push({message:n,element:e,method:t.method}),this.errorMap[e.name]=n,this.submitted[e.name]=n},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t,n;for(e=0;this.errorList[e];e++)n=this.errorList[e],this.settings.highlight&&this.settings.highlight.call(this,n.element,this.settings.errorClass,this.settings.validClass),this.showLabel(n.element,n.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,n){var i,o,a,r,s=this.errorsFor(t),l=this.idOrName(t),d=e(t).attr("aria-describedby");s.length?(s.removeClass(this.settings.validClass).addClass(this.settings.errorClass),s.html(n)):(s=e("<"+this.settings.errorElement+">").attr("id",l+"-error").addClass(this.settings.errorClass).html(n||""),i=s,this.settings.wrapper&&(i=s.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(i):this.settings.errorPlacement?this.settings.errorPlacement(i,e(t)):i.insertAfter(t),s.is("label")?s.attr("for",l):0===s.parents("label[for='"+this.escapeCssMeta(l)+"']").length&&(a=s.attr("id"),d?d.match(new RegExp("\\b"+this.escapeCssMeta(a)+"\\b"))||(d+=" "+a):d=a,e(t).attr("aria-describedby",d),o=this.groups[t.name],o&&(r=this,e.each(r.groups,function(t,n){n===o&&e("[name='"+r.escapeCssMeta(t)+"']",r.currentForm).attr("aria-describedby",s.attr("id"))})))),!n&&this.settings.success&&(s.text(""),"string"==typeof this.settings.success?s.addClass(this.settings.success):this.settings.success(s,t)),this.toShow=this.toShow.add(s)},errorsFor:function(t){var n=this.escapeCssMeta(this.idOrName(t)),i=e(t).attr("aria-describedby"),o="label[for='"+n+"'], label[for='"+n+"'] *";return i&&(o=o+", #"+this.escapeCssMeta(i).replace(/\s+/g,", #")),this.errors().filter(o)},escapeCssMeta:function(e){return e.replace(/([\\!"#$%&'()*+,.\/:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name)),e(t).not(this.settings.ignore)[0]},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+this.escapeCssMeta(t)+"']")},getLength:function(t,n){switch(n.nodeName.toLowerCase()){case"select":return e("option:selected",n).length;case"input":if(this.checkable(n))return this.findByName(n.name).filter(":checked").length}return t.length},depend:function(e,t){return this.dependTypes[typeof e]?this.dependTypes[typeof e](e,t):!0},dependTypes:{"boolean":function(e){return e},string:function(t,n){return!!e(t,n.form).length},"function":function(e,t){return e(t)}},optional:function(t){var n=this.elementValue(t);return!e.validator.methods.required.call(this,n,t)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,e(t).addClass(this.settings.pendingClass),this.pending[t.name]=!0)},stopRequest:function(t,n){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],e(t).removeClass(this.settings.pendingClass),n&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!n&&0===this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t,n){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,{method:n})})},destroy:function(){this.resetForm(),e(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur");
}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,n){t.constructor===String?this.classRuleSettings[t]=n:e.extend(this.classRuleSettings,t)},classRules:function(t){var n={},i=e(t).attr("class");return i&&e.each(i.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(n,e.validator.classRuleSettings[this])}),n},normalizeAttributeRule:function(e,t,n,i){/min|max|step/.test(n)&&(null===t||/number|range|text/.test(t))&&(i=Number(i),isNaN(i)&&(i=void 0)),i||0===i?e[n]=i:t===n&&"range"!==t&&(e[n]=!0)},attributeRules:function(t){var n,i,o={},a=e(t),r=t.getAttribute("type");for(n in e.validator.methods)"required"===n?(i=t.getAttribute(n),""===i&&(i=!0),i=!!i):i=a.attr(n),this.normalizeAttributeRule(o,r,n,i);return o.maxlength&&/-1|2147483647|524288/.test(o.maxlength)&&delete o.maxlength,o},dataRules:function(t){var n,i,o={},a=e(t),r=t.getAttribute("type");for(n in e.validator.methods)i=a.data("rule"+n.charAt(0).toUpperCase()+n.substring(1).toLowerCase()),this.normalizeAttributeRule(o,r,n,i);return o},staticRules:function(t){var n={},i=e.data(t.form,"validator");return i.settings.rules&&(n=e.validator.normalizeRule(i.settings.rules[t.name])||{}),n},normalizeRules:function(t,n){return e.each(t,function(i,o){if(o===!1)return void delete t[i];if(o.param||o.depends){var a=!0;switch(typeof o.depends){case"string":a=!!e(o.depends,n.form).length;break;case"function":a=o.depends.call(n,n)}a?t[i]=void 0!==o.param?o.param:!0:(e.data(n.form,"validator").resetElements(e(n)),delete t[i])}}),e.each(t,function(i,o){t[i]=e.isFunction(o)&&"normalizer"!==i?o(n):o}),e.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){var n;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(n=t[this].replace(/[\[\]]/g,"").split(/[\s,]+/),t[this]=[Number(n[0]),Number(n[1])]))}),e.validator.autoCreateRanges&&(null!=t.min&&null!=t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),null!=t.minlength&&null!=t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var n={};e.each(t.split(/\s/),function(){n[this]=!0}),t=n}return t},addMethod:function(t,n,i){e.validator.methods[t]=n,e.validator.messages[t]=void 0!==i?i:e.validator.messages[t],n.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,n,i){if(!this.depend(i,n))return"dependency-mismatch";if("select"===n.nodeName.toLowerCase()){var o=e(n).val();return o&&o.length>0}return this.checkable(n)?this.getLength(t,n)>0:t.length>0},email:function(e,t){return this.optional(t)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)},url:function(e,t){return this.optional(t)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e).toString())},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:function(e,t){return this.optional(t)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},minlength:function(t,n,i){var o=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||o>=i},maxlength:function(t,n,i){var o=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||i>=o},rangelength:function(t,n,i){var o=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||o>=i[0]&&o<=i[1]},min:function(e,t,n){return this.optional(t)||e>=n},max:function(e,t,n){return this.optional(t)||n>=e},range:function(e,t,n){return this.optional(t)||e>=n[0]&&e<=n[1]},step:function(t,n,i){var o=e(n).attr("type"),a="Step attribute on input type "+o+" is not supported.",r=["text","number","range"],s=new RegExp("\\b"+o+"\\b"),l=o&&!s.test(r.join());if(l)throw new Error(a);return this.optional(n)||t%i===0},equalTo:function(t,n,i){var o=e(i);return this.settings.onfocusout&&o.not(".validate-equalTo-blur").length&&o.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){e(n).valid()}),t===o.val()},remote:function(t,n,i,o){if(this.optional(n))return"dependency-mismatch";o="string"==typeof o&&o||"remote";var a,r,s,l=this.previousValue(n,o);return this.settings.messages[n.name]||(this.settings.messages[n.name]={}),l.originalMessage=l.originalMessage||this.settings.messages[n.name][o],this.settings.messages[n.name][o]=l.message,i="string"==typeof i&&{url:i}||i,s=e.param(e.extend({data:t},i.data)),l.old===s?l.valid:(l.old=s,a=this,this.startRequest(n),r={},r[n.name]=t,e.ajax(e.extend(!0,{mode:"abort",port:"validate"+n.name,dataType:"json",data:r,context:a.currentForm,success:function(e){var i,r,s,d=e===!0||"true"===e;a.settings.messages[n.name][o]=l.originalMessage,d?(s=a.formSubmitted,a.resetInternals(),a.toHide=a.errorsFor(n),a.formSubmitted=s,a.successList.push(n),a.invalid[n.name]=!1,a.showErrors()):(i={},r=e||a.defaultMessage(n,{method:o,parameters:t}),i[n.name]=l.message=r,a.invalid[n.name]=!0,a.showErrors(i)),l.valid=d,a.stopRequest(n,d)}},i)),"pending")}}});var t,n={};e.ajaxPrefilter?e.ajaxPrefilter(function(e,t,i){var o=e.port;"abort"===e.mode&&(n[o]&&n[o].abort(),n[o]=i)}):(t=e.ajax,e.ajax=function(i){var o=("mode"in i?i:e.ajaxSettings).mode,a=("port"in i?i:e.ajaxSettings).port;return"abort"===o?(n[a]&&n[a].abort(),n[a]=t.apply(this,arguments),n[a]):t.apply(this,arguments)})}),function(e){"function"==typeof define&&define.amd?define(["jquery","./jquery.validate"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){!function(){function t(e){return e.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'\"_+=\/\-“”’]*/g,"")}e.validator.addMethod("maxWords",function(e,n,i){return this.optional(n)||t(e).match(/\b\w+\b/g).length<=i},e.validator.format("Please enter {0} words or less.")),e.validator.addMethod("minWords",function(e,n,i){return this.optional(n)||t(e).match(/\b\w+\b/g).length>=i},e.validator.format("Please enter at least {0} words.")),e.validator.addMethod("rangeWords",function(e,n,i){var o=t(e),a=/\b\w+\b/g;return this.optional(n)||o.match(a).length>=i[0]&&o.match(a).length<=i[1]},e.validator.format("Please enter between {0} and {1} words."))}(),e.validator.addMethod("accept",function(t,n,i){var o,a,r,s="string"==typeof i?i.replace(/\s/g,""):"image/*",l=this.optional(n);if(l)return l;if("file"===e(n).attr("type")&&(s=s.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$&").replace(/,/g,"|").replace("/*","/.*"),n.files&&n.files.length))for(r=new RegExp(".?("+s+")$","i"),o=0;o<n.files.length;o++)if(a=n.files[o],!a.type.match(r))return!1;return!0},e.validator.format("Please enter a value with a valid mimetype.")),e.validator.addMethod("alphanumeric",function(e,t){return this.optional(t)||/^\w+$/i.test(e)},"Letters, numbers, and underscores only please"),e.validator.addMethod("bankaccountNL",function(e,t){if(this.optional(t))return!0;if(!/^[0-9]{9}|([0-9]{2} ){3}[0-9]{3}$/.test(e))return!1;var n,i,o,a=e.replace(/ /g,""),r=0,s=a.length;for(n=0;s>n;n++)i=s-n,o=a.substring(n,n+1),r+=i*o;return r%11===0},"Please specify a valid bank account number"),e.validator.addMethod("bankorgiroaccountNL",function(t,n){return this.optional(n)||e.validator.methods.bankaccountNL.call(this,t,n)||e.validator.methods.giroaccountNL.call(this,t,n)},"Please specify a valid bank or giro account number"),e.validator.addMethod("bic",function(e,t){return this.optional(t)||/^([A-Z]{6}[A-Z2-9][A-NP-Z1-9])(X{3}|[A-WY-Z0-9][A-Z0-9]{2})?$/.test(e.toUpperCase())},"Please specify a valid BIC code"),e.validator.addMethod("cifES",function(e){"use strict";var t,n,i,o,a,r,s=[];if(e=e.toUpperCase(),!e.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)"))return!1;for(i=0;9>i;i++)s[i]=parseInt(e.charAt(i),10);for(n=s[2]+s[4]+s[6],o=1;8>o;o+=2)a=(2*s[o]).toString(),r=a.charAt(1),n+=parseInt(a.charAt(0),10)+(""===r?0:parseInt(r,10));return/^[ABCDEFGHJNPQRSUVW]{1}/.test(e)?(n+="",t=10-parseInt(n.charAt(n.length-1),10),e+=t,s[8].toString()===String.fromCharCode(64+t)||s[8].toString()===e.charAt(e.length-1)):!1},"Please specify a valid CIF number."),e.validator.addMethod("cpfBR",function(e){if(e=e.replace(/([~!@#$%^&*()_+=`{}\[\]\-|\\:;'<>,.\/? ])+/g,""),11!==e.length)return!1;var t,n,i,o,a=0;if(t=parseInt(e.substring(9,10),10),n=parseInt(e.substring(10,11),10),i=function(e,t){var n=10*e%11;return 10!==n&&11!==n||(n=0),n===t},""===e||"00000000000"===e||"11111111111"===e||"22222222222"===e||"33333333333"===e||"44444444444"===e||"55555555555"===e||"66666666666"===e||"77777777777"===e||"88888888888"===e||"99999999999"===e)return!1;for(o=1;9>=o;o++)a+=parseInt(e.substring(o-1,o),10)*(11-o);if(i(a,t)){for(a=0,o=1;10>=o;o++)a+=parseInt(e.substring(o-1,o),10)*(12-o);return i(a,n)}return!1},"Please specify a valid CPF number"),e.validator.addMethod("creditcard",function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9 \-]+/.test(e))return!1;var n,i,o=0,a=0,r=!1;if(e=e.replace(/\D/g,""),e.length<13||e.length>19)return!1;for(n=e.length-1;n>=0;n--)i=e.charAt(n),a=parseInt(i,10),r&&(a*=2)>9&&(a-=9),o+=a,r=!r;return o%10===0},"Please enter a valid credit card number."),e.validator.addMethod("creditcardtypes",function(e,t,n){if(/[^0-9\-]+/.test(e))return!1;e=e.replace(/\D/g,"");var i=0;return n.mastercard&&(i|=1),n.visa&&(i|=2),n.amex&&(i|=4),n.dinersclub&&(i|=8),n.enroute&&(i|=16),n.discover&&(i|=32),n.jcb&&(i|=64),n.unknown&&(i|=128),n.all&&(i=255),1&i&&/^(5[12345])/.test(e)?16===e.length:2&i&&/^(4)/.test(e)?16===e.length:4&i&&/^(3[47])/.test(e)?15===e.length:8&i&&/^(3(0[012345]|[68]))/.test(e)?14===e.length:16&i&&/^(2(014|149))/.test(e)?15===e.length:32&i&&/^(6011)/.test(e)?16===e.length:64&i&&/^(3)/.test(e)?16===e.length:64&i&&/^(2131|1800)/.test(e)?15===e.length:!!(128&i)},"Please enter a valid credit card number."),e.validator.addMethod("currency",function(e,t,n){var i,o="string"==typeof n,a=o?n:n[0],r=o?!0:n[1];return a=a.replace(/,/g,""),a=r?a+"]":a+"]?",i="^["+a+"([1-9]{1}[0-9]{0,2}(\\,[0-9]{3})*(\\.[0-9]{0,2})?|[1-9]{1}[0-9]{0,}(\\.[0-9]{0,2})?|0(\\.[0-9]{0,2})?|(\\.[0-9]{1,2})?)$",i=new RegExp(i),this.optional(t)||i.test(e)},"Please specify a valid currency"),e.validator.addMethod("dateFA",function(e,t){return this.optional(t)||/^[1-4]\d{3}\/((0?[1-6]\/((3[0-1])|([1-2][0-9])|(0?[1-9])))|((1[0-2]|(0?[7-9]))\/(30|([1-2][0-9])|(0?[1-9]))))$/.test(e)},e.validator.messages.date),e.validator.addMethod("dateITA",function(e,t){var n,i,o,a,r,s=!1,l=/^\d{1,2}\/\d{1,2}\/\d{4}$/;return l.test(e)?(n=e.split("/"),i=parseInt(n[0],10),o=parseInt(n[1],10),a=parseInt(n[2],10),r=new Date(Date.UTC(a,o-1,i,12,0,0,0)),s=r.getUTCFullYear()===a&&r.getUTCMonth()===o-1&&r.getUTCDate()===i):s=!1,this.optional(t)||s},e.validator.messages.date),e.validator.addMethod("dateNL",function(e,t){return this.optional(t)||/^(0?[1-9]|[12]\d|3[01])[\.\/\-](0?[1-9]|1[012])[\.\/\-]([12]\d)?(\d\d)$/.test(e)},e.validator.messages.date),e.validator.addMethod("extension",function(e,t,n){return n="string"==typeof n?n.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(new RegExp("\\.("+n+")$","i"))},e.validator.format("Please enter a value with a valid extension.")),e.validator.addMethod("giroaccountNL",function(e,t){return this.optional(t)||/^[0-9]{1,7}$/.test(e)},"Please specify a valid giro account number"),e.validator.addMethod("iban",function(e,t){if(this.optional(t))return!0;var n,i,o,a,r,s,l,d,c,u=e.replace(/ /g,"").toUpperCase(),p="",m=!0,f="",h="";if(n=u.substring(0,2),s={AL:"\\d{8}[\\dA-Z]{16}",AD:"\\d{8}[\\dA-Z]{12}",AT:"\\d{16}",AZ:"[\\dA-Z]{4}\\d{20}",BE:"\\d{12}",BH:"[A-Z]{4}[\\dA-Z]{14}",BA:"\\d{16}",BR:"\\d{23}[A-Z][\\dA-Z]",BG:"[A-Z]{4}\\d{6}[\\dA-Z]{8}",CR:"\\d{17}",HR:"\\d{17}",CY:"\\d{8}[\\dA-Z]{16}",CZ:"\\d{20}",DK:"\\d{14}",DO:"[A-Z]{4}\\d{20}",EE:"\\d{16}",FO:"\\d{14}",FI:"\\d{14}",FR:"\\d{10}[\\dA-Z]{11}\\d{2}",GE:"[\\dA-Z]{2}\\d{16}",DE:"\\d{18}",GI:"[A-Z]{4}[\\dA-Z]{15}",GR:"\\d{7}[\\dA-Z]{16}",GL:"\\d{14}",GT:"[\\dA-Z]{4}[\\dA-Z]{20}",HU:"\\d{24}",IS:"\\d{22}",IE:"[\\dA-Z]{4}\\d{14}",IL:"\\d{19}",IT:"[A-Z]\\d{10}[\\dA-Z]{12}",KZ:"\\d{3}[\\dA-Z]{13}",KW:"[A-Z]{4}[\\dA-Z]{22}",LV:"[A-Z]{4}[\\dA-Z]{13}",LB:"\\d{4}[\\dA-Z]{20}",LI:"\\d{5}[\\dA-Z]{12}",LT:"\\d{16}",LU:"\\d{3}[\\dA-Z]{13}",MK:"\\d{3}[\\dA-Z]{10}\\d{2}",MT:"[A-Z]{4}\\d{5}[\\dA-Z]{18}",MR:"\\d{23}",MU:"[A-Z]{4}\\d{19}[A-Z]{3}",MC:"\\d{10}[\\dA-Z]{11}\\d{2}",MD:"[\\dA-Z]{2}\\d{18}",ME:"\\d{18}",NL:"[A-Z]{4}\\d{10}",NO:"\\d{11}",PK:"[\\dA-Z]{4}\\d{16}",PS:"[\\dA-Z]{4}\\d{21}",PL:"\\d{24}",PT:"\\d{21}",RO:"[A-Z]{4}[\\dA-Z]{16}",SM:"[A-Z]\\d{10}[\\dA-Z]{12}",SA:"\\d{2}[\\dA-Z]{18}",RS:"\\d{18}",SK:"\\d{20}",SI:"\\d{15}",ES:"\\d{20}",SE:"\\d{20}",CH:"\\d{5}[\\dA-Z]{12}",TN:"\\d{20}",TR:"\\d{5}[\\dA-Z]{17}",AE:"\\d{3}\\d{16}",GB:"[A-Z]{4}\\d{14}",VG:"[\\dA-Z]{4}\\d{16}"},r=s[n],"undefined"!=typeof r&&(l=new RegExp("^[A-Z]{2}\\d{2}"+r+"$",""),!l.test(u)))return!1;for(i=u.substring(4,u.length)+u.substring(0,4),d=0;d<i.length;d++)o=i.charAt(d),"0"!==o&&(m=!1),m||(p+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(o));for(c=0;c<p.length;c++)a=p.charAt(c),h=""+f+a,f=h%97;return 1===f},"Please specify a valid IBAN"),e.validator.addMethod("integer",function(e,t){return this.optional(t)||/^-?\d+$/.test(e)},"A positive or negative non-decimal number please"),e.validator.addMethod("ipv4",function(e,t){return this.optional(t)||/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(e)},"Please enter a valid IP v4 address."),e.validator.addMethod("ipv6",function(e,t){return this.optional(t)||/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(e)},"Please enter a valid IP v6 address."),e.validator.addMethod("lettersonly",function(e,t){return this.optional(t)||/^[a-z]+$/i.test(e)},"Letters only please"),e.validator.addMethod("letterswithbasicpunc",function(e,t){return this.optional(t)||/^[a-z\-.,()'"\s]+$/i.test(e)},"Letters or punctuation only please"),e.validator.addMethod("mobileNL",function(e,t){return this.optional(t)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)6((\s|\s?\-\s?)?[0-9]){8}$/.test(e)},"Please specify a valid mobile number"),e.validator.addMethod("mobileUK",function(e,t){return e=e.replace(/\(|\)|\s+|-/g,""),this.optional(t)||e.length>9&&e.match(/^(?:(?:(?:00\s?|\+)44\s?|0)7(?:[1345789]\d{2}|624)\s?\d{3}\s?\d{3})$/)},"Please specify a valid mobile number"),e.validator.addMethod("nieES",function(e){"use strict";return e=e.toUpperCase(),e.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)")?/^[T]{1}/.test(e)?e[8]===/^[T]{1}[A-Z0-9]{8}$/.test(e):/^[XYZ]{1}/.test(e)?e[8]==="TRWAGMYFPDXBNJZSQVHLCKE".charAt(e.replace("X","0").replace("Y","1").replace("Z","2").substring(0,8)%23):!1:!1},"Please specify a valid NIE number."),e.validator.addMethod("nifES",function(e){"use strict";return e=e.toUpperCase(),e.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)")?/^[0-9]{8}[A-Z]{1}$/.test(e)?"TRWAGMYFPDXBNJZSQVHLCKE".charAt(e.substring(8,0)%23)===e.charAt(8):/^[KLM]{1}/.test(e)?e[8]===String.fromCharCode(64):!1:!1},"Please specify a valid NIF number."),jQuery.validator.addMethod("notEqualTo",function(t,n,i){return this.optional(n)||!e.validator.methods.equalTo.call(this,t,n,i)},"Please enter a different value, values must not be the same."),e.validator.addMethod("nowhitespace",function(e,t){return this.optional(t)||/^\S+$/i.test(e)},"No white space please"),e.validator.addMethod("pattern",function(e,t,n){return this.optional(t)?!0:("string"==typeof n&&(n=new RegExp("^(?:"+n+")$")),n.test(e))},"Invalid format."),e.validator.addMethod("phoneNL",function(e,t){return this.optional(t)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)[1-9]((\s|\s?\-\s?)?[0-9]){8}$/.test(e)},"Please specify a valid phone number."),e.validator.addMethod("phoneUK",function(e,t){return e=e.replace(/\(|\)|\s+|-/g,""),this.optional(t)||e.length>9&&e.match(/^(?:(?:(?:00\s?|\+)44\s?)|(?:\(?0))(?:\d{2}\)?\s?\d{4}\s?\d{4}|\d{3}\)?\s?\d{3}\s?\d{3,4}|\d{4}\)?\s?(?:\d{5}|\d{3}\s?\d{3})|\d{5}\)?\s?\d{4,5})$/)},"Please specify a valid phone number"),e.validator.addMethod("phoneUS",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]([02-9]\d|1[02-9])\)|[2-9]([02-9]\d|1[02-9]))-?[2-9]([02-9]\d|1[02-9])-?\d{4}$/)},"Please specify a valid phone number"),e.validator.addMethod("phonesUK",function(e,t){return e=e.replace(/\(|\)|\s+|-/g,""),this.optional(t)||e.length>9&&e.match(/^(?:(?:(?:00\s?|\+)44\s?|0)(?:1\d{8,9}|[23]\d{9}|7(?:[1345789]\d{8}|624\d{6})))$/)},"Please specify a valid uk phone number"),e.validator.addMethod("postalCodeCA",function(e,t){return this.optional(t)||/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ] *\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i.test(e)},"Please specify a valid postal code"),e.validator.addMethod("postalcodeBR",function(e,t){return this.optional(t)||/^\d{2}.\d{3}-\d{3}?$|^\d{5}-?\d{3}?$/.test(e)},"Informe um CEP válido."),e.validator.addMethod("postalcodeIT",function(e,t){return this.optional(t)||/^\d{5}$/.test(e)},"Please specify a valid postal code"),e.validator.addMethod("postalcodeNL",function(e,t){return this.optional(t)||/^[1-9][0-9]{3}\s?[a-zA-Z]{2}$/.test(e)},"Please specify a valid postal code"),e.validator.addMethod("postcodeUK",function(e,t){return this.optional(t)||/^((([A-PR-UWYZ][0-9])|([A-PR-UWYZ][0-9][0-9])|([A-PR-UWYZ][A-HK-Y][0-9])|([A-PR-UWYZ][A-HK-Y][0-9][0-9])|([A-PR-UWYZ][0-9][A-HJKSTUW])|([A-PR-UWYZ][A-HK-Y][0-9][ABEHMNPRVWXY]))\s?([0-9][ABD-HJLNP-UW-Z]{2})|(GIR)\s?(0AA))$/i.test(e)},"Please specify a valid UK postcode"),e.validator.addMethod("require_from_group",function(t,n,i){var o=e(i[1],n.form),a=o.eq(0),r=a.data("valid_req_grp")?a.data("valid_req_grp"):e.extend({},this),s=o.filter(function(){return r.elementValue(this)}).length>=i[0];return a.data("valid_req_grp",r),e(n).data("being_validated")||(o.data("being_validated",!0),o.each(function(){r.element(this)}),o.data("being_validated",!1)),s},e.validator.format("Please fill at least {0} of these fields.")),e.validator.addMethod("skip_or_fill_minimum",function(t,n,i){var o=e(i[1],n.form),a=o.eq(0),r=a.data("valid_skip")?a.data("valid_skip"):e.extend({},this),s=o.filter(function(){return r.elementValue(this)}).length,l=0===s||s>=i[0];return a.data("valid_skip",r),e(n).data("being_validated")||(o.data("being_validated",!0),o.each(function(){r.element(this)}),o.data("being_validated",!1)),l},e.validator.format("Please either skip these fields or fill at least {0} of them.")),e.validator.addMethod("stateUS",function(e,t,n){var i,o="undefined"==typeof n,a=o||"undefined"==typeof n.caseSensitive?!1:n.caseSensitive,r=o||"undefined"==typeof n.includeTerritories?!1:n.includeTerritories,s=o||"undefined"==typeof n.includeMilitary?!1:n.includeMilitary;return i=r||s?r&&s?"^(A[AEKLPRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$":r?"^(A[KLRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$":"^(A[AEKLPRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$":"^(A[KLRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$",i=a?new RegExp(i):new RegExp(i,"i"),this.optional(t)||i.test(e)},"Please specify a valid state"),e.validator.addMethod("strippedminlength",function(t,n,i){return e(t).text().length>=i},e.validator.format("Please enter at least {0} characters")),e.validator.addMethod("time",function(e,t){return this.optional(t)||/^([01]\d|2[0-3]|[0-9])(:[0-5]\d){1,2}$/.test(e)},"Please enter a valid time, between 00:00 and 23:59"),e.validator.addMethod("time12h",function(e,t){return this.optional(t)||/^((0?[1-9]|1[012])(:[0-5]\d){1,2}(\ ?[AP]M))$/i.test(e)},"Please enter a valid time in 12-hour am/pm format"),e.validator.addMethod("url2",function(e,t){return this.optional(t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},e.validator.messages.url),e.validator.addMethod("vinUS",function(e){if(17!==e.length)return!1;var t,n,i,o,a,r,s=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","R","S","T","U","V","W","X","Y","Z"],l=[1,2,3,4,5,6,7,8,1,2,3,4,5,7,9,2,3,4,5,6,7,8,9],d=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],c=0;for(t=0;17>t;t++){if(o=d[t],i=e.slice(t,t+1),8===t&&(r=i),isNaN(i)){for(n=0;n<s.length;n++)if(i.toUpperCase()===s[n]){i=l[n],i*=o,isNaN(r)&&8===n&&(r=s[n]);break}}else i*=o;c+=i}return a=c%11,10===a&&(a="X"),a===r},"The specified vehicle identification number (VIN) is invalid."),e.validator.addMethod("zipcodeUS",function(e,t){return this.optional(t)||/^\d{5}(-\d{4})?$/.test(e)},"The specified US ZIP Code is invalid"),e.validator.addMethod("ziprange",function(e,t){return this.optional(t)||/^90[2-5]\d\{2\}-\d{4}$/.test(e)},"Your ZIP-code must be in the range 902xx-xxxx to 905xx-xxxx")});var EasyAutocomplete=function(e){return e.Configuration=function(e){function t(){if("xml"===e.dataType&&(e.getValue||(e.getValue=function(e){return $(e).text()}),e.list||(e.list={}),e.list.sort||(e.list.sort={}),e.list.sort.method=function(t,n){return t=e.getValue(t),n=e.getValue(n),n>t?-1:t>n?1:0},e.list.match||(e.list.match={}),e.list.match.method=function(t,n){return t=e.getValue(t),n=e.getValue(n),t===n}),void 0!==e.categories&&e.categories instanceof Array){for(var t=[],n=0,i=e.categories.length;i>n;n+=1){var o=e.categories[n];for(var a in s.categories[0])void 0===o[a]&&(o[a]=s.categories[0][a]);t.push(o)}e.categories=t}}function n(){function t(e,n){var i=e||{};for(var o in e)void 0!==n[o]&&null!==n[o]&&("object"!=typeof n[o]||n[o]instanceof Array?i[o]=n[o]:t(e[o],n[o]));return void 0!==n.data&&null!==n.data&&"object"==typeof n.data&&(i.data=n.data),i}s=t(s,e)}function i(){if("list-required"!==s.url&&"function"!=typeof s.url){var t=s.url;s.url=function(){return t}}if(void 0!==s.ajaxSettings.url&&"function"!=typeof s.ajaxSettings.url){var t=s.ajaxSettings.url;s.ajaxSettings.url=function(){return t}}if("string"==typeof s.listLocation){var n=s.listLocation;s.listLocation="XML"===s.dataType.toUpperCase()?function(e){return $(e).find(n)}:function(e){return e[n]}}if("string"==typeof s.getValue){var i=s.getValue;s.getValue=function(e){return e[i]}}void 0!==e.categories&&(s.categoriesAssigned=!0)}function o(){s.ajaxSettings=void 0!==e.ajaxSettings&&"object"==typeof e.ajaxSettings?e.ajaxSettings:{}}function a(e){return void 0!==s[e]&&null!==s[e]}function r(e,t){function n(t,o){for(var a in o)void 0===t[a]&&e.log("Property '"+a+"' does not exist in EasyAutocomplete options API."),"object"!=typeof t[a]||i(a)||n(t[a],o[a])}function i(e){var t=["ajaxSettings","template"];return Array.prototype.contains=function(e){for(var t=this.length;t--;)if(this[t]===e)return!0;return!1},t.contains(e)}n(s,t)}var s={data:"list-required",url:"list-required",dataType:"json",listLocation:function(e){return e},xmlElementName:"",getValue:function(e){return e},autocompleteOff:!0,placeholder:!1,ajaxCallback:function(){},matchResponseProperty:!1,list:{sort:{enabled:!1,method:function(e,t){return e=s.getValue(e),t=s.getValue(t),t>e?-1:e>t?1:0}},maxNumberOfElements:6,hideOnEmptyPhrase:!0,match:{enabled:!1,caseSensitive:!1,method:function(e,t){return e=s.getValue(e),t=s.getValue(t),e===t}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}},onClickEvent:function(){},onSelectItemEvent:function(){},onLoadEvent:function(){},onChooseEvent:function(){},onKeyEnterEvent:function(){},onMouseOverEvent:function(){},onMouseOutEvent:function(){},onShowListEvent:function(){},onHideListEvent:function(){}},highlightPhrase:!0,theme:"",cssClasses:"",minCharNumber:0,requestDelay:0,adjustWidth:!0,ajaxSettings:{},preparePostData:function(e){return e},loggerEnabled:!0,template:"",categoriesAssigned:!1,categories:[{maxNumberOfElements:4}]};this.get=function(e){return s[e]},this.equals=function(e,t){return!(!a(e)||s[e]!==t)},this.checkDataUrlProperties=function(){return"list-required"!==s.url||"list-required"!==s.data},this.checkRequiredProperties=function(){for(var e in s)if("required"===s[e])return logger.error("Option "+e+" must be defined"),!1;return!0},this.printPropertiesThatDoesntExist=function(e,t){r(e,t)},t(),n(),s.loggerEnabled===!0&&r(console,e),o(),i()},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Logger=function(){this.error=function(e){console.log("ERROR: "+e)},this.warning=function(e){console.log("WARNING: "+e)}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Constans=function(){var e={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"eac-container-",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(t){return e[t]}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.ListBuilderService=function(e,t){function n(t,n){function i(){var i,o={};return void 0!==t.xmlElementName&&(o.xmlElementName=t.xmlElementName),void 0!==t.listLocation?i=t.listLocation:void 0!==e.get("listLocation")&&(i=e.get("listLocation")),void 0!==i?"string"==typeof i?o.data=$(n).find(i):"function"==typeof i&&(o.data=i(n)):o.data=n,o}function o(){var e={};return void 0!==t.listLocation?"string"==typeof t.listLocation?e.data=n[t.listLocation]:"function"==typeof t.listLocation&&(e.data=t.listLocation(n)):e.data=n,e}var a={};if(a="XML"===e.get("dataType").toUpperCase()?i():o(),void 0!==t.header&&(a.header=t.header),void 0!==t.maxNumberOfElements&&(a.maxNumberOfElements=t.maxNumberOfElements),void 0!==e.get("list").maxNumberOfElements&&(a.maxListSize=e.get("list").maxNumberOfElements),void 0!==t.getValue)if("string"==typeof t.getValue){var r=t.getValue;a.getValue=function(e){return e[r]}}else"function"==typeof t.getValue&&(a.getValue=t.getValue);else a.getValue=e.get("getValue");return a}function i(t){var n=[];return void 0===t.xmlElementName&&(t.xmlElementName=e.get("xmlElementName")),$(t.data).find(t.xmlElementName).each(function(){n.push(this)}),n}this.init=function(t){var n=[],i={};return i.data=e.get("listLocation")(t),i.getValue=e.get("getValue"),i.maxListSize=e.get("list").maxNumberOfElements,n.push(i),n},this.updateCategories=function(t,i){if(e.get("categoriesAssigned")){t=[];for(var o=0;o<e.get("categories").length;o+=1){var a=n(e.get("categories")[o],i);t.push(a)}}return t},this.convertXml=function(t){if("XML"===e.get("dataType").toUpperCase())for(var n=0;n<t.length;n+=1)t[n].data=i(t[n]);return t},this.processData=function(n,i){for(var o=0,a=n.length;a>o;o+=1)n[o].data=t(e,n[o],i);return n},this.checkIfDataExists=function(e){for(var t=0,n=e.length;n>t;t+=1)if(void 0!==e[t].data&&e[t].data instanceof Array&&e[t].data.length>0)return!0;return!1}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.proccess=function(e,t,n){function i(t,n){var i=[],o="";if(e.get("list").match.enabled)for(var a=0,r=t.length;r>a;a+=1)o=e.get("getValue")(t[a]),e.get("list").match.caseSensitive||("string"==typeof o&&(o=o.toLowerCase()),n=n.toLowerCase()),o.search(n)>-1&&i.push(t[a]);else i=t;return i}function o(e){return void 0!==t.maxNumberOfElements&&e.length>t.maxNumberOfElements&&(e=e.slice(0,t.maxNumberOfElements)),e}function a(t){return e.get("list").sort.enabled&&t.sort(e.get("list").sort.method),t}var r=t.data,s=n;return r=i(r,s),r=o(r),r=a(r)},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Template=function(e){var t={basic:{type:"basic",method:function(e){return e},cssClass:""},description:{type:"description",fields:{description:"description"},method:function(e){return e+" - description"},cssClass:"eac-description"},iconLeft:{type:"iconLeft",fields:{icon:""},method:function(e){return e},cssClass:"eac-icon-left"},iconRight:{type:"iconRight",fields:{iconSrc:""},method:function(e){return e},cssClass:"eac-icon-right"},links:{type:"links",fields:{link:""},method:function(e){return e},cssClass:""},custom:{type:"custom",method:function(){},cssClass:""}},n=function(e){var n,i=e.fields;return"description"===e.type?(n=t.description.method,"string"==typeof i.description?n=function(e,t){return e+" - <span>"+t[i.description]+"</span>"}:"function"==typeof i.description&&(n=function(e,t){return e+" - <span>"+i.description(t)+"</span>"}),n):"iconRight"===e.type?("string"==typeof i.iconSrc?n=function(e,t){return e+"<img class='eac-icon' src='"+t[i.iconSrc]+"' />"}:"function"==typeof i.iconSrc&&(n=function(e,t){return e+"<img class='eac-icon' src='"+i.iconSrc(t)+"' />"}),n):"iconLeft"===e.type?("string"==typeof i.iconSrc?n=function(e,t){return"<img class='eac-icon' src='"+t[i.iconSrc]+"' />"+e}:"function"==typeof i.iconSrc&&(n=function(e,t){return"<img class='eac-icon' src='"+i.iconSrc(t)+"' />"+e}),n):"links"===e.type?("string"==typeof i.link?n=function(e,t){return"<a href='"+t[i.link]+"' >"+e+"</a>"}:"function"==typeof i.link&&(n=function(e,t){return"<a href='"+i.link(t)+"' >"+e+"</a>"}),n):"custom"===e.type?e.method:t.basic.method},i=function(e){return e&&e.type&&e.type&&t[e.type]?n(e):t.basic.method},o=function(e){var n=function(){return""};return e&&e.type&&e.type&&t[e.type]?function(){var n=t[e.type].cssClass;return function(){return n}}():n};this.getTemplateClass=o(e),
this.build=i(e)},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.main=function(t,n){function i(){return 0===y.length?void h.error("Input field doesn't exist."):f.checkDataUrlProperties()?f.checkRequiredProperties()?(o(),void r()):void h.error("Will not work without mentioned properties."):void h.error("One of options variables 'data' or 'url' must be defined.")}function o(){function e(){var e=$("<div>"),n=m.getValue("WRAPPER_CSS_CLASS");f.get("theme")&&""!==f.get("theme")&&(n+=" eac-"+f.get("theme")),f.get("cssClasses")&&""!==f.get("cssClasses")&&(n+=" "+f.get("cssClasses")),""!==g.getTemplateClass()&&(n+=" "+g.getTemplateClass()),e.addClass(n),y.wrap(e),f.get("adjustWidth")===!0&&t()}function t(){var e=y.outerWidth();y.parent().css("width",e)}function n(){y.unwrap()}function i(){var e=$("<div>").addClass(m.getValue("CONTAINER_CLASS"));e.attr("id",a()).prepend($("<ul>")),function(){e.on("show.eac",function(){switch(f.get("list").showAnimation.type){case"slide":var t=f.get("list").showAnimation.time,n=f.get("list").showAnimation.callback;e.find("ul").slideDown(t,n);break;case"fade":var t=f.get("list").showAnimation.time,n=f.get("list").showAnimation.callback;e.find("ul").fadeIn(t),n;break;default:e.find("ul").show()}f.get("list").onShowListEvent()}).on("hide.eac",function(){switch(f.get("list").hideAnimation.type){case"slide":var t=f.get("list").hideAnimation.time,n=f.get("list").hideAnimation.callback;e.find("ul").slideUp(t,n);break;case"fade":var t=f.get("list").hideAnimation.time,n=f.get("list").hideAnimation.callback;e.find("ul").fadeOut(t,n);break;default:e.find("ul").hide()}f.get("list").onHideListEvent()}).on("selectElement.eac",function(){e.find("ul li").removeClass("selected"),e.find("ul li").eq(A).addClass("selected"),f.get("list").onSelectItemEvent()}).on("loadElements.eac",function(t,n,i){var o="",a=e.find("ul");a.empty().detach(),T=[];for(var s=0,l=0,c=n.length;c>l;l+=1){var u=n[l].data;if(0!==u.length){void 0!==n[l].header&&n[l].header.length>0&&a.append("<div class='eac-category' >"+n[l].header+"</div>");for(var p=0,m=u.length;m>p&&s<n[l].maxListSize;p+=1)o=$("<li><div class='eac-item'></div></li>"),function(){var e=p,t=s,a=n[l].getValue(u[e]);o.find(" > div").on("click",function(){y.val(a).trigger("change"),A=t,d(t),f.get("list").onClickEvent(),f.get("list").onChooseEvent()}).mouseover(function(){A=t,d(t),f.get("list").onMouseOverEvent()}).mouseout(function(){f.get("list").onMouseOutEvent()}).html(g.build(r(a,i),u[e]))}(),a.append(o),T.push(u[p]),s+=1}}e.append(a),f.get("list").onLoadEvent()})}(),y.after(e)}function o(){y.next("."+m.getValue("CONTAINER_CLASS")).remove()}function r(e,t){return f.get("highlightPhrase")&&""!==t?l(e,t):e}function s(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function l(e,t){var n=s(t);return(e+"").replace(new RegExp("("+n+")","gi"),"<b>$1</b>")}y.parent().hasClass(m.getValue("WRAPPER_CSS_CLASS"))&&(o(),n()),e(),i(),E=$("#"+a()),f.get("placeholder")&&y.attr("placeholder",f.get("placeholder"))}function a(){var e=y.attr("id");return e=m.getValue("CONTAINER_ID")+e}function r(){function e(){b("autocompleteOff",!0)&&r(),t(),n(),i(),o(),a()}function t(){y.off("keyup").keyup(function(e){function t(e){function t(){var e={},t=f.get("ajaxSettings")||{};for(var n in t)e[n]=t[n];return e}function n(e,t){return f.get("matchResponseProperty")!==!1?"string"==typeof f.get("matchResponseProperty")?t[f.get("matchResponseProperty")]===e:"function"==typeof f.get("matchResponseProperty")?f.get("matchResponseProperty")(t)===e:!0:!0}if(!(e.length<f.get("minCharNumber"))){if("list-required"!==f.get("data")){var i=f.get("data"),o=v.init(i);o=v.updateCategories(o,i),o=v.processData(o,e),c(o,e),y.parent().find("li").length>0?s():l()}var a=t();(void 0===a.url||""===a.url)&&(a.url=f.get("url")),(void 0===a.dataType||""===a.dataType)&&(a.dataType=f.get("dataType")),void 0!==a.url&&"list-required"!==a.url&&(a.url=a.url(e),a.data=f.get("preparePostData")(a.data,e),$.ajax(a).done(function(t){var i=v.init(t);i=v.updateCategories(i,t),i=v.convertXml(i),n(e,t)&&(i=v.processData(i,e),c(i,e)),v.checkIfDataExists(i)&&y.parent().find("li").length>0?s():l(),f.get("ajaxCallback")()}).fail(function(){h.warning("Fail to load response data")}).always(function(){}))}}switch(e.keyCode){case 27:l(),u();break;case 38:e.preventDefault(),T.length>0&&A>0&&(A-=1,y.val(f.get("getValue")(T[A])),d(A));break;case 40:e.preventDefault(),T.length>0&&A<T.length-1&&(A+=1,y.val(f.get("getValue")(T[A])),d(A));break;default:if(e.keyCode>40||8===e.keyCode){var n=y.val();f.get("list").hideOnEmptyPhrase!==!0||8!==e.keyCode||""!==n?f.get("requestDelay")>0?(void 0!==p&&clearTimeout(p),p=setTimeout(function(){t(n)},f.get("requestDelay"))):t(n):l()}}})}function n(){y.on("keydown",function(e){e=e||window.event;var t=e.keyCode;return 38===t?(suppressKeypress=!0,!1):void 0}).keydown(function(e){13===e.keyCode&&A>-1&&(y.val(f.get("getValue")(T[A])),f.get("list").onKeyEnterEvent(),f.get("list").onChooseEvent(),A=-1,l(),e.preventDefault())})}function i(){y.off("keypress")}function o(){y.focus(function(){""!==y.val()&&T.length>0&&(A=-1,s())})}function a(){y.blur(function(){setTimeout(function(){A=-1,l()},250)})}function r(){y.attr("autocomplete","off")}e()}function s(){E.trigger("show.eac")}function l(){E.trigger("hide.eac")}function d(e){E.trigger("selectElement.eac",e)}function c(e,t){E.trigger("loadElements.eac",[e,t])}function u(){y.trigger("blur")}var p,m=new e.Constans,f=new e.Configuration(n),h=new e.Logger,g=new e.Template(n.template),v=new e.ListBuilderService(f,e.proccess),b=f.equals,y=t,E="",T=[],A=-1;e.consts=m,this.getConstants=function(){return m},this.getConfiguration=function(){return f},this.getContainer=function(){return E},this.getSelectedItemIndex=function(){return A},this.getItemData=function(e){return T.length<e||void 0===T[e]?-1:T[e]},this.getSelectedItemData=function(){return this.getItemData(A)},this.build=function(){o()},this.init=function(){i()}},e.easyAutocompleteHandles=[],e.inputHasId=function(e){return void 0!==$(e).attr("id")&&$(e).attr("id").length>0},e.assignRandomId=function(t){var n="";do n="eac-"+Math.floor(1e4*Math.random());while(0!==$("#"+n).length);elementId=e.consts.getValue("CONTAINER_ID")+n,$(t).attr("id",n)},e}(EasyAutocomplete||{});$.fn.easyAutocomplete=function(e){return this.each(function(){var t=$(this),n=new EasyAutocomplete.main(t,e);EasyAutocomplete.inputHasId(t)||EasyAutocomplete.assignRandomId(t),n.init(),EasyAutocomplete.easyAutocompleteHandles[t.attr("id")]=n})},$.fn.getSelectedItemIndex=function(){var e=$(this).attr("id");return void 0!==e?EasyAutocomplete.easyAutocompleteHandles[e].getSelectedItemIndex():-1},$.fn.getItemData=function(e){var t=$(this).attr("id");return void 0!==t&&e>-1?EasyAutocomplete.easyAutocompleteHandles[t].getItemData(e):-1},$.fn.getSelectedItemData=function(){var e=$(this).attr("id");return void 0!==e?EasyAutocomplete.easyAutocompleteHandles[e].getSelectedItemData():-1};