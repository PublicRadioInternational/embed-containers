var EntityEmbed=EntityEmbed||{};!function(){function e(e){return e=$.extend(!0,{},i,e),e.data.debug=e.debug,$.support.cors=!0,$.ajax({timeout:15e3,crossDomain:!0,type:e.methodType,dataType:"json",url:e.path,data:JSON.stringify(e.data)}).done(e.success).fail(e.fail).always(e.always)}function t(e){e&&(i.debug=1)}var i={success:function(){},fail:function(){},always:function(){},data:{},debug:0,path:""};t.prototype.put=function(t){return t.methodType="POST",e(t)},t.prototype.post=function(t){return t.methodType="POST",e(t)},t.prototype.get=function(t){return t.methodType="POST",e(t)},EntityEmbed.apiService=new t(!0)}();var EntityEmbed=EntityEmbed||{};!function(){var e={},t="entity-embed-active",i="medium-editor-button-active",n="medium-insert-images-toolbar",o="medium-insert-images-toolbar2",a="entity-embed-secondary-toolbar-locator",r=function(e,t){var i="";t?(i="medium-insert-images-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active ",i+=t+"StyleToolbar"):i="medium-insert-images-toolbar2 medium-editor-toolbar medium-editor-toolbar-active";var n='<div class="'+i+'"><ul class="medium-editor-toolbar-actions clearfix">';for(var o in e){var a=e[o];a.label&&(n+='<li><button class="medium-editor-action" data-action="'+o+'">'+a.label+"</button></li>")}return n+="</ul></div>"};toolbarManager=function(e,i,n,o){var a=this;a.mediumEditorAddon=e,a.styles=i,a.actions=n,o&&(t=o),a.events()},toolbarManager.prototype.events=function(){var e=this;$(document).on("click","."+n+" .medium-editor-action",function(){e.styleToolbarDo($(this))}).on("click","."+o+" .medium-editor-action",function(){e.actionToolbarDo($(this))})},toolbarManager.prototype.createActionToolbar=function(e){var t=this;e.append(r(t.actions)),t.$actionToolbar=$("."+o),t.$actionToolbar.hide()},toolbarManager.prototype.createStyleToolbar=function(t,i){var o=this,a=$.extend(o.styles,{}),s=!0;if(i.options.styles){for(var d in i.options.styles)i.options.styles[d]?s=!1:delete a[d];s||(t.append(r(a,i.name)),e[i.name]=$("."+n+"."+i.name+"StyleToolbar"),e[i.name].hide())}},toolbarManager.prototype.showToolbars=function(n,o){var a,r=this,s=$("."+t);r.currentToolbarEmbedType=o,r.$actionToolbar.show(),e[r.currentToolbarEmbedType]&&(e[r.currentToolbarEmbedType].find("button").each(function(){s.hasClass("entity-embed-"+$(this).data("action"))&&(a=$(this),a.addClass(i))}),e[r.currentToolbarEmbedType].show(),a&&a.addClass(i)),r.positionToolbars(n)},toolbarManager.prototype.styleToolbarDo=function(e){var n=this,o=e.closest("li").closest("ul"),a=$("."+t);o.find("."+i).removeClass(i),e.addClass(i),o.find("button").each(function(){var e=$(this),t="entity-embed-"+e.data("action");e.hasClass(i)?n.addStyle(a,t,e.data("action"),!0):(a.removeClass(t),n.styles[e.data("action")].removed&&n.styles[e.data("action")].removed(a))})},toolbarManager.prototype.addStyle=function(e,i,n,o){var a=this;e.addClass(i),a.styles[n].added&&a.styles[n].added(e),o&&setTimeout(function(){a.positionToolbars($("."+t))},50)},toolbarManager.prototype.actionToolbarDo=function(e){var i=this,n=$("."+t),o=i.actions[e.data("action")].clicked;o(i.mediumEditorAddon,n)},toolbarManager.prototype.hideToolbar=function(){var t=this;t.$actionToolbar.hide(),t.$actionToolbar.find("button").removeClass(i),t.currentToolbarEmbedType&&e[t.currentToolbarEmbedType]&&(e[t.currentToolbarEmbedType].hide(),e[t.currentToolbarEmbedType].find("button").removeClass(i),t.currentToolbarEmbedType=null)},toolbarManager.prototype.positionToolbars=function(t){var i=this,n=t.find("."+a);0===n.length&&(n=t),s=t.offset().top+2;var o=n.offset().left+n.width()+4;o>$(window).width()-i.$actionToolbar.width()&&(s-=i.$actionToolbar.height()+8,o=$(window).width()-i.$actionToolbar.width()-50),i.$actionToolbar.css({top:s,left:o});var r=e[i.currentToolbarEmbedType];if(r){var s=t.offset().top-r.height()-8-2-5;0>s&&(s=0),r.css({top:s,left:t.offset().left+t.width()/2-r.width()/2})}},EntityEmbed.toolbarManager=toolbarManager}();var EntityEmbedTypes=EntityEmbedTypes||{},EntityEmbed=EntityEmbed||{};!function(){"use strict";function e(e,t,i,n){var o=n||this;o.name=i,t=$.extend(!0,{},o.defaultOptions,t),o.options=$.extend(!0,{},t,e),o.init()}e.prototype.defaultOptions={viewPath:"",displayName:"Generic",httpPaths:{put:"https://test-services.pri.org/admin/embed/edit",post:"https://test-services.pri.org/admin/embed/edit",get:"https://test-services.pri.org/admin/embed/fetch",getAll:"https://test-services.pri.org/admin/embed/list"},styles:{left:!0,right:!0,center:!0,wide:!0},validationOptions:{}},e.prototype.cleanModel=function(){return{}},e.prototype.defaultStyle="entity-embed-center",e.prototype.init=function(){var e=this;e.model=e.cleanModel()},e.prototype.initModal=function(e){},e.prototype.getModelFromForm=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;n<i.length;n++){var o=i[n].name,a=i[n].value;o&&a&&(t.model[o]=a)}},e.prototype.populateFormWithModel=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;n<i.length;n++)if(i[n].type&&-1!==i[n].type.indexOf("select")){var o=$(i[n]).find("option"),a=t.model[i[n].name],r=0;o.each(function(e){this.value===a&&(r=e)}),i[n].selectedIndex=r}else t.model[i[n].name]&&(i[n].value=t.model[i[n].name])},e.prototype.clearForm=function(e){for(var t=this,i=e.find("form"),n=0;n<i.length;n++)i[n].reset();t.model=t.cleanModel()},e.prototype.editorEvents=function(){},e.prototype.parseForEditor=function(){return'<pre class="embedded-content">'+JSON.stringify(this.model,null,4)+"</pre>"},e.prototype.validate=function(e){var t=this,i=e.find("form");return i.validate(t.options.validationOptions)},e.prototype.saveEmbed=function(e,t,i){var n=this;return n.model.auth_token="abc123",e?(n.model.object_type=n.options.object_type,EntityEmbed.apiService.post({path:n.options.httpPaths.post,data:n.model,success:t,fail:i})):EntityEmbed.apiService.put({path:n.options.httpPaths.put,data:n.model,success:t,fail:i})},EntityEmbedTypes.genericEmbed=e,Function.prototype.inherits||(Function.prototype.inherits=function(e){var t=this;return t.prototype=new e,t.prototype.constructor=t,t.prototype.parent=e.prototype,t})}(),function(){"use strict";function e(e,i,n){var o=this;o.$el=$(e),o.options=$.extend(!0,{},t,i),o.scope={},n&&(o.scope=n),o.scope.modalCtrl=o,o.$el.data("scope",o.scope),o.options.functions.init.before(o.scope),o.init(),o.options.functions.init.after(o.scope)}var t={contentClass:"embed-modal",backdropClass:"embed-modal-backdrop",closeBtnIcon:"fa fa-times",showCloseBtn:!0,$openEl:$(""),$abortEl:$(""),$completeEl:$(""),functions:{init:{before:function(e){},after:function(e){}},open:{before:function(e){},after:function(e){}},abort:{before:function(e){return!0},after:function(e){}},complete:{before:function(e){return!0},after:function(e){}}}};e.prototype.isActive=!1,e.prototype.activeClass="em-active",e.prototype.closeBtnClass="em-close-btn",e.prototype.generateId=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.prototype.backdropHtml=function(e){var t=this;return'<div id="'+e+'" class="'+t.options.backdropClass+'"></div>'},e.prototype.closeBtnHtml=function(e){var t=this,i=t.closeBtnClass+" "+t.options.closeBtnIcon;return'<i id="'+e+'"" class="'+i+'"></i>'},e.prototype.toggle=function(e){e.$el.toggleClass(e.activeClass),e.$backdrop.toggleClass(e.activeClass),e.$closeBtn.toggleClass(e.activeClass),e.isActive=!e.isActive},e.prototype.init=function(){var e=this;e.$el.addClass(e.options.contentClass);var t=e.generateId();if(e.$el.before(e.backdropHtml(t)),e.$backdrop=$("#"+t),e.$backdrop.click(function(){e.$el.abortModal()}),e.options.showCloseBtn){var i=e.generateId();e.$el.prepend(e.closeBtnHtml(i)),e.$closeBtn=$("."+e.closeBtnClass+"#"+i),e.$closeBtn.click(function(){e.$el.abortModal()})}e.options.$openEl.click(function(){e.$el.openModal()}),e.options.$completeEl.click(function(){e.$el.completeModal()}),e.options.$abortEl.click(function(){e.$el.abortModal()})},e.prototype.registerEvent=function(e,t,i,n){var o=this;o.$el.find(e).on(t,function(e){i(e,o.$el.data("scope"),n)})},$.fn.modal=function(t,i){return this.each(function(){$.data(this,"ctrl")||(t||(t={}),$.data(this,"ctrl",new e(this,t,i)))})},$.fn.openModal=function(e){return this.each(function(){var t=$.data(this,"ctrl");if(t&&!t.isActive){if(e){var i=t.$el.data("scope"),n=$.extend(!0,{},i,e);t.$el.data("scope",n)}t.options.functions.open.before(t.$el.data("scope")),t.toggle(t),t.options.functions.open.after(t.$el.data("scope"));var o=.1*$(window).height(),a=t.$el.css("top");a.replace("px",""),a=parseInt(a),a=o+$(document).scrollTop(),t.$el.css("top",a)}})},$.fn.abortModal=function(e){return this.each(function(){var t=$.data(this,"ctrl");if(t&&t.isActive){if(e){var i=t.$el.data("scope"),n=$.extend(!0,{},i,e);t.$el.data("scope",n)}t.options.functions.abort.before(t.$el.data("scope"))&&(t.toggle(t),t.options.functions.abort.after(t.$el.data("scope")))}})},$.fn.completeModal=function(e){return this.each(function(){var t=$.data(this,"ctrl");if(t&&t.isActive){if(e){var i=t.$el.data("scope"),n=$.extend(!0,{},i,e);t.$el.data("scope",n)}t.options.functions.complete.before(t.$el.data("scope"))&&(t.toggle(t),t.options.functions.complete.after(t.$el.data("scope")))}})}}();var EntityEmbed=EntityEmbed||{};!function(){function e(e){var i=this;e||(e={}),i.options=$.extend(!0,{},t,e),i.init()}var t={modalId:"leave-confirmation-modal",viewPath:"modal/modal_confirmation.html",abortElId:"btn-cancel-leave",completeElId:"btn-confirm-leave"};e.prototype.init=function(){var e=this;e.$abortEl=$("#"+e.options.abortElId),e.$completeEl=$("#"+e.options.completeElId)},e.prototype.functions={init:{before:function(e){},after:function(e){}},open:{before:function(e){},after:function(e){}},abort:{before:function(e){return!0},after:function(e){}},complete:{before:function(e){return e.parentModalCtrl.$el.abortModal({confirmedLeave:!0}),!0},after:function(e){}}},EntityEmbed.confirmModalDefaults=e}();var EntityEmbed=EntityEmbed||{};!function(){function e(){}EntityEmbed.embedModalTypes={add:0,edit:1,selectExisting:2};var t=void 0,i={buttons:{saveEmbed:"#btn-save-modal",abortModal:"#btn-abort-modal",showSelectExisting:"#btn-show-select-existing",selectExisting:"#btn-select-existing-embed",cancelSelectExisting:"#btn-cancel-select-existing"},containers:{createNewEmbed:"#embed-modal-create-new",selectExistingEmbed:"#embed-modal-select-existing",createButtons:"#embed-modal-buttons-create",selectButtons:"#embed-modal-buttons-select"},elements:{selectExistingTableBody:".embed-modal-select-existing tbody",selectExistingTableRow:".embed-modal-select-existing-item",selectExistingActiveItem:"embed-modal-active-row"}},n=function(e,t){return'<tr class="embed-modal-select-existing-item" id="'+t+'"><td>'+e+"</tr></td>"},o=function(e,t){$(".editable").attr("contenteditable",t)},a=function(e){var t=!1;return e.find(":input:not(:button):not([type=hidden])").each(function(){var e=this;if(("text"==e.type||"textarea"==e.type||"hidden"==e.type)&&e.defaultValue!=e.value)return t=!0,!1;if(("radio"==e.type||"checkbox"==e.type)&&e.defaultChecked!=e.checked)return t=!0,!1;if("select-one"==this.type||"select-multiple"==this.type)for(var i=0;i<this.length;i++)if(this.options[i].selected!=this.options[i].defaultSelected)return hasChanges=!0,!1}),t},r=function(e,t){t&&(e.currentEmbedType&&(e.currentEmbedType.$view.hide(),e.currentEmbedType.clearForm(e.currentEmbedType.$view)),e.currentEmbedType=p(t),e.currentEmbedType.$view.show(),e.$embedTypeSelect[0].selectedIndex=e.currentEmbedType.optionIndex)},s=function(e){var t=e.embedTypes[0].options.object_type;r(e,t),e.$embedTypeSelect.show()},d=function(e){var t=e.currentEmbedType.validate(e.currentEmbedType.$view);if(e.currentEmbedType.$view.find("form").valid()){e.currentEmbedType.getModelFromForm(e.currentEmbedType.$view);var i=e.modalType==EntityEmbed.embedModalTypes.add;if(i)var n=function(t){return"ERROR"===t.status?void console.log("POST failed"):"string"==typeof t.response?void console.log("Failed to POST embed type: "+t.response):(e.currentEmbedType.model.object_id=t.response.object_id,console.log("POST succeeded"),void e.modalCtrl.$el.completeModal())},o=function(e){console.log("POST failed")};else var n=function(t){return"ERROR"===t.status?void console.log("PUT failed"):"string"==typeof t.response?void console.log("Failed to PUT embed type: "+t.response):(console.log("PUT succeeded"),void e.modalCtrl.$el.completeModal())},o=function(e){console.log("PUT failed")};e.currentEmbedType.saveEmbed(i,n,o),t.resetForm()}},l=function(e){$(i.elements.selectExistingTableRow).remove(),EntityEmbed.apiService.post({path:e.currentEmbedType.options.httpPaths.getAll,data:{object_type:e.currentEmbedType.options.object_type,auth_token:"abc123"},success:function(t){if("string"==typeof data.response)return void console.log("Failed to get list of current embed types for the Select Existing page.: "+data.response);if(t.response.data){e.selectExistingItems=t.response.data;for(var o=0;o<e.selectExistingItems.length;o++){var a=$(n(e.selectExistingItems[o].title,e.selectExistingItems[o].object_id));$(i.elements.selectExistingTableBody).append(a),e.modalCtrl.registerEvent(a,"click",function(e,t){var n=!$(e.currentTarget).hasClass(i.elements.selectExistingActiveItem);$(i.elements.selectExistingTableBody).find("."+i.elements.selectExistingActiveItem).removeClass(i.elements.selectExistingActiveItem),n?($(e.currentTarget).addClass(i.elements.selectExistingActiveItem),$(i.buttons.selectExisting).removeClass("disabled")):$(i.buttons.selectExisting).addClass("disabled")})}}},fail:function(e){console.log("Failed to get list of current embed types for the Select Existing page.")}})},c=function(e){$(i.buttons.showSelectExisting).show(),e.$embedTypeSelect.show(),$(i.containers.selectExistingEmbed).slideUp(),$(i.containers.createNewEmbed).slideDown(),$(i.containers.selectButtons).hide(),$(i.containers.createButtons).show()},u=function(e){$(i.buttons.showSelectExisting).hide(),e.$embedTypeSelect.hide(),$(i.containers.selectExistingEmbed).is(":visible")&&($(i.containers.selectExistingEmbed).slideUp(),$(i.containers.createNewEmbed).slideDown()),$(i.containers.selectButtons).hide(),$(i.containers.createButtons).show(),$(i.buttons.showSelectExisting).hide()},p=function(e){var i=$.grep(t,function(t){return t.options.object_type==e});return i.length>0?i[0]:null},m=function(e,t){var i='<figure contenteditable="false" id="'+e.model.object_id+'" data-embed-type="'+e.options.object_type+'" >'+e.parseForEditor()+"</figure>";return t?'<div class="entity-embed-container">'+i+"</div>":i};e.prototype.generateEmbedHtml=m,e.prototype.functions={init:{before:function(e){e.currentEmbedType=null,t=e.embedTypes},after:function(e){e.$modalBody.find(i.containers.selectExistingEmbed).load("modal/modal_selectedExisting.html",function(e,t,n){console.log("modal_selectedExisting.html load completed with status: "+t),$(i.buttons.selectExisting).addClass("disabled")});for(var t=0,n=0;n<e.embedTypes.length;n++){var o=e.embedTypes[n];e.$embedTypeSelect.append('<option value="'+o.options.object_type+'">'+o.options.displayName+"</option>"),e.$modalBody.find(i.containers.createNewEmbed).append('<div id="'+o.name+'"></div>');var a=e.$modalBody.find("#"+o.name);a.load(o.options.viewPath,function(e,t,i){console.log(o.options.viewPath+" load completed with status: "+t)}),o.$view=a,o.optionIndex=t,a.hide(),t++}setTimeout(function(){for(var t=0;t<e.embedTypes.length;t++)e.embedTypes[t].initModal(e.embedTypes[t].$view)},200);var s=new EntityEmbed.confirmModalDefaults;i.elements.confirmModal="#"+s.options.modalId,$("#"+s.options.modalId).load(s.options.viewPath,function(t,i,n){if(console.log("leave confirmation modal load completed with status: "+i),"error"!==i){var o={parentModalCtrl:e.modalCtrl};s.init(),$("#"+s.options.modalId).modal(s,o)}}),e.modalCtrl.registerEvent(e.$embedTypeSelect,"change",function(e,t){t.currentEmbedType.clearForm(t.currentEmbedType.$view);var i=e.currentTarget.options[e.currentTarget.selectedIndex].value;r(t,i),t.modalType===EntityEmbed.embedModalTypes.selectExisting&&l(t)}),e.modalCtrl.registerEvent(i.buttons.saveEmbed,"click",function(e,t){d(t)}),e.modalCtrl.registerEvent(i.buttons.showSelectExisting,"click",function(e,t){t.modalType=EntityEmbed.embedModalTypes.selectExisting,l(t),$(i.containers.createNewEmbed).slideUp(),$(i.containers.selectExistingEmbed).slideDown(),$(i.containers.createButtons).hide(),$(i.containers.selectButtons).show()}),e.modalCtrl.registerEvent(i.buttons.cancelSelectExisting,"click",function(e,t){t.modalType=EntityEmbed.embedModalTypes.add,c(t)}),e.modalCtrl.registerEvent(i.buttons.selectExisting,"click",function(e,t){$(i.buttons.selectExisting).hasClass("disabled")||EntityEmbed.apiService.get({path:t.currentEmbedType.options.httpPaths.get,data:{object_id:$("."+i.elements.selectExistingActiveItem).attr("id"),auth_token:"abc123"},success:function(e){return"string"==typeof e.response?void console.log("Failed to get list of current embed types for the Select Existing page.: "+e.response):(t.currentEmbedType.model=e.response,void t.modalCtrl.$el.completeModal())},fail:function(e){console.log("failed to get embed type!")}})})}},open:{before:function(e){o(e,"false")},after:function(e){e.modalType==EntityEmbed.embedModalTypes.edit?(EntityEmbed.apiService.get({path:e.currentEmbedType.options.httpPaths.get,data:{object_id:e.embedId,auth_token:"abc123"},success:function(t){return"string"==typeof t.response?void console.log("Failed to get embed type: "+t.response):(r(e,t.response.object_type),u(e),e.currentEmbedType.model=t.response,e.staleModel=$.extend(!0,{},t.response),void e.currentEmbedType.populateFormWithModel(e.currentEmbedType.$view))},fail:function(e){console.log("failed to get embed type!")}}),delete e.embedType):e.modalType==EntityEmbed.embedModalTypes.add&&(c(e),e.embedType?(r(e,e.embedType),e.$embedTypeSelect.hide()):s(e))}},abort:{before:function(e){if(!e.confirmedLeave)if(e.modalType===EntityEmbed.embedModalTypes.edit&&e.staleModel){e.currentEmbedType.getModelFromForm(e.currentEmbedType.$view);for(var t in e.currentEmbedType.model)if(!e.staleModel[t]||e.staleModel[t]!==e.currentEmbedType.model[t])return $(i.elements.confirmModal).openModal(),!1}else if(a(e.currentEmbedType.$view))return $(i.elements.confirmModal).openModal(),!1;var n=e.currentEmbedType.validate(e.currentEmbedType.$view);return n.resetForm(),delete e.confirmedLeave,!0},after:function(e){o(e,"true")}},complete:{before:function(e){return!0},after:function(e){o(e,"true"),e.$currentEditorLocation.addClass("entity-embed-editor-line");var t=e.$currentEditorLocation.html(m(e.currentEmbedType,!0)),i=jQuery.Event("entityEmbedAdded");i.embedType=e.currentEmbedType,t.find(".entity-embed-container").trigger(i)}}},$.fn.embedModalOpen_add=function(e){var t={$currentEditorLocation:$(".medium-insert-active"),modalType:EntityEmbed.embedModalTypes.add,embedType:e};this.openModal(t)},$.fn.embedModalOpen_edit=function(e,t){var i={$currentEditorLocation:$(".medium-insert-active"),modalType:EntityEmbed.embedModalTypes.edit,embedId:t,embedType:e};this.openModal(i)},EntityEmbed.embedModalDefaults=e}(),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="audio",o={viewPath:e+"modal/modal_audio.html",displayName:"Audio",object_type:"audio",validationOptions:{debug:!0,rules:{title:"required",url:"required",mp3File:{required:!0,extension:"mp3"},wavFile:{extension:"wav"}}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=3,i.prototype.cleanModel=function(){return{title:null,file:[],credit:null,creditLink:null}},i.prototype.initModal=function(e){var t=this;e.find(".audio-file-group").fileupload({dataType:"json",replaceFileInput:!1,add:function(e,i){i.submit().complete(function(e,i,n){"success"===i?e&&e.responseJSON&&e.responseJSON.path&&(t.model.file=e.responseJSON.path):(console.log('file upload completed with status "'+i+'"'),console.log(e))})}})},i.prototype.clearForm=function(e){var t=this;t.parent.clearForm(e)},i.prototype.parseForEditor=function(){var e=this,t=e.model.file.substring(e.model.file.lastIndexOf(".")+1);return'<div class="audio-embed"><audio controls><source src="'+e.model.file+'" type="audio/'+t+'"></audio><div class="credit">Credit: '+e.model.credit+'</div><div class="link">Link: '+e.model.creditLink+"</div></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,a,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="customText",o="custom-text-editor",a={viewPath:e+"modal/modal_customText.html",displayName:"Custom Text",object_type:"custom",validationOptions:{rules:{title:"required",customText:"required"}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=5,i.prototype.getModelFromForm=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;n<i.length;n++){var a,r;i[n].id==o?(a=i[n].attributes.name.nodeValue,r=i[n].innerHTML):(a=i[n].name,r=i[n].value),a&&r&&(t.model[a]=r)}},i.prototype.cleanModel=function(){return{title:null,displayTitle:null,text:null}},i.prototype.clearForm=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;n<i.length;n++)i[n].type&&-1!==i[n].type.indexOf("select")?i[n].selectedIndex=0:(i[n].value=null,i[n].innerHTML="");t.model=t.cleanModel()},i.prototype.populateFormWithModel=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;n<i.length;n++)if(i.type&&-1!==i[n].type.indexOf("select")){var a=$(i[n]).find("option"),r=t.model[i[n].name],s=0;a.each(function(e){this.value===r&&(s=e)}),i[n].selectedIndex=s}else i[n].value=t.model[i[n].name],i[n].id==o&&(i[n].innerHTML=t.model[i[n].attributes.name.nodeValue])},i.prototype.initModal=function(e){new MediumEditor("#"+o)},i.prototype.parseForEditor=function(){var e=this;return'<div class="custom-text-embed"><div class="display-title">'+e.model.displayTitle+'</div><div class="custom-text">'+e.model.customText+"</div></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="externalLink",o={viewPath:e+"modal/modal_externalLink.html",displayName:"External Link",object_type:"external-link",validationOptions:{rules:{title:"required",url:"required",linkText:"required"}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=9,i.prototype.cleanModel=function(){return{thumbnailFile:null,title:null,displayTitle:null,teaser:null,linkText:null,url:null}},i.prototype.initModal=function(e){var t=this;e.find("input[name='thumbnailFile']").fileupload({dataType:"json",replaceFileInput:!1,add:function(e,i){i.submit().complete(function(e,i,n){"success"===i?e&&e.responseJSON&&e.responseJSON.path&&(t.model.thumbnailFile=e.responseJSON.path):(console.log('file upload completed with status "'+i+'"'),console.log(e))})}})},i.prototype.parseForEditor=function(){var e=this;return'<div class="external-link-embed entity-embed-secondary-toolbar-locator"><div class="display-title">'+e.model.displayTitle+'</div><div class="teaser">'+e.model.teaser+'</div><a class="btn btn-primary external-link" href="'+e.model.url+'">'+e.model.linkText+"</a></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="facebook",o={viewPath:e+"modal/modal_facebook.html",displayName:"Facebook",object_type:"facebook",validationOptions:{rules:{title:"required",url:"required"}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=7,i.prototype.getModelFromForm=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;n<i.length;n++){var o=i[n].name,a=i[n].value;o&&a&&(t.model[o]=a)}var r="embedCode",s='<script>(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) return;js = d.createElement(s);js.id = id;js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";fjs.parentNode.insertBefore(js, fjs);}(document, "script", "facebook-jssdk"));</script><div class="fb-post" data-href="'+this.model.url+'" data-width="500"></div>';t.model[r]=s},i.prototype.cleanModel=function(){return{title:null,url:null}},i.prototype.parseForEditor=function(){var e=this;return'<div class="facebook-embed"><div class="facebook-info"><span>click here to show the toolbars</span></div><div class="overlay">'+e.model.embedCode+'</div><div class="facebook-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="globalBuzz",o={viewPath:e+"modal/modal_globalBuzz.html",displayName:"Global Buzz",object_type:"global-buzz",validationOptions:{rules:{title:"required",quote:"required",url:"required"}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=13,i.prototype.cleanModel=function(){return{title:null,quote:null,credit:null,quoteUrl:null}},i.prototype.parseForEditor=function(){var e=this;return'<div class="global-buzz"><article class="global-buzz-quote-wrapper engagement-badge-wrapper"><div class="engagement-badge"></div><div><h1 class="global-buzz-teaser">Global Buzz</h1><div class="buzz-field-quote"><img class ="buzz-field-quote-png" src="http://www.pri.org/sites/all/themes/pri/images/icon-open-quote.png"><div class="buzz-quote-inner">'+e.model.quote+'</div></div><div class="buzz-field-quote-credit">'+e.model.credit+'</div><a class="btn btn-primary global-buzz-link" href="'+e.model.quoteUrl+'">'+e.model.quoteUrlText+"</a></div></div></article></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="iframe",o={viewPath:e+"modal/modal_iframe.html",displayName:"iFrame",object_type:"iframe",validationOptions:{rules:{title:"required",url:"required"}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=11,i.prototype.cleanModel=function(){return{title:null,url:null,allowsScroll:!1}},i.prototype.parseForEditor=function(){return'<div class="iframe-embed"><div class="iframe-info"><span>click here to show the toolbars</span></div><iframe src="'+this.model.url+'" frameborder="0" scrolling="'+this.model.allowsScroll+'"></iframe><div class="iframe-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes);var EntityEmbed=EntityEmbed||{};!function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="image",o={viewPath:e+"modal/modal_image.html",displayName:"Image(s)",object_type:"image",validationOptions:{rules:{title:"required",altText:"required",license:"required",imageFile:{required:!0,extension:"png|jpg|jpeg|gif"}}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=1,i.prototype.cleanModel=function(){return{file:null,title:null,altText:null,credit:null,creditLink:null,caption:null,license:null}},i.prototype.loadLicenses=function(){var e=this;EntityEmbed.apiService.get({path:e.options.httpPaths.get,data:{object_id:"5a0b9980894a4e898d03eb08e279099f",auth_token:"abc123"},success:function(e){if(e.response.list){for(var t=[],i=0;i<e.response.list.length;i++)t[i]="<option>"+e.response.list[i].licenseName+"</option>";$("#license").html(t)}},fail:function(e){console.log("failed to find load image license options")}})},i.prototype.initModal=function(e){var t=this;t.loadLicenses(),e.find('input[name="imageFile"]').fileupload({dataType:"json",replaceFileInput:!1,add:function(e,i){i.submit().complete(function(e,i,n){"success"===i?e&&e.responseJSON&&e.responseJSON.path&&(t.model.file=e.responseJSON.path):(console.log('file upload completed with status "'+i+'"'),console.log(e))})}})},i.prototype.clearForm=function(e){var t=this;t.parent.clearForm(e),t.model.file=null},i.prototype.parseForEditor=function(){var e=this;return'<div class="images-embed"><img class="entity-embed-secondary-toolbar-locator" src="'+e.model.file+'" /><div class="images-embed-caption">'+e.model.caption+'</div><div class="images-embed-credit">Credit: '+e.model.credit+"</div></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="instagram",o={viewPath:e+"modal/modal_instagram.html",displayName:"Instagram",object_type:"instagram",validationOptions:{rules:{title:"required",url:"required"}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=8,i.prototype.getModelFromForm=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;n<i.length;n++){var o=i[n].name,a=i[n].value;o&&a&&(t.model[o]=a)}var r="embedCode",s='<blockquote class="instagram-media" data-instgrm-captioned data-instgrm-version="6" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: auto; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px); "><a href="'+t.model.url+'" style=" color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;" target="_blank"></a></blockquote><script async defer src="//platform.instagram.com/en_US/embeds.js"></script>';t.model[r]=s},i.prototype.cleanModel=function(){return{title:null,url:null}},i.prototype.parseForEditor=function(){var e=this;return'<div class="instagram-embed"><div class="instagram-info"><span>click here to show the toolbars</span></div><div class="overlay">'+e.model.embedCode+'</div><div class="instagram-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes);var EntityEmbed=EntityEmbed||{};!function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="newsletterSubscribe",o={viewPath:e+"modal/modal_newsletterSubscribe.html",displayName:"Newsletter Subscribe",object_type:"newsletter",validationOptions:{rules:{title:"required",newsletter:"required"}}},a=function(e){EntityEmbed.apiService.get({path:e,data:{object_id:"5a0b9980894a4e898d03eb08e279099f",auth_token:"abc123"},success:function(e){if(e.response.list){for(var t=[],i=0;i<e.response.list.length;i++)t[i]='<option value="'+e.response.list[i].licenseCode+'" >'+e.response.list[i].licenseName+"</option>";$("#subscription").html(t)}},fail:function(e){console.log("failed to load newsletter subscription options")}})};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=12,i.prototype.cleanModel=function(){return{title:null,displayTitle:null,newsletterId:null,teaser:null}},i.prototype.initModal=function(e){a(this.options.httpPaths.get)},i.prototype.parseForEditor=function(){var e=this;return'<div class="newsletter-subscribe-embed entity-embed-secondary-toolbar-locator"><div class="display-title">'+e.model.displayTitle+'</div><div class="subscribe-form"><div class="teaser">'+e.model.teaser+'</div><div class="embed-modal-form"><input name="email" type="text" placeholder="user@domain.com" class="embed-modal-form-control"></div><button class="btn btn-primary subscribe-btn">Subscribe</button>';
}}("",EntityEmbedTypes);var EntityEmbed=EntityEmbed||{};!function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="relatedLink",o={viewPath:e+"modal/modal_relatedLink.html",displayName:"Related Link",object_type:"related-link",validationOptions:{rules:{title:"required"}}},a=[],r=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=10,i.prototype.cleanModel=function(){return{title:null,displayTitle:null,links:[]}};var s=function(e,t){EntityEmbed.apiService.get({path:t.options.httpPaths.get,data:{object_id:"dbbc5fc38d2e4d359572743d2c00d581",auth_token:"abc123"},success:function(t){var i={data:t.response.stories,getValue:"Title",list:{maxNumberOfElements:10,match:{enabled:!0},sort:{enabled:!0}}};$(e).easyAutocomplete(i),$(e).focus()},fail:function(e){console.log("failed to retrieve any stories!")}})};i.prototype.getModelFromForm=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;2>n;n++){var o=i[n].name,r=i[n].value;o&&r&&(t.model[o]=r)}for(var n=0;n<a.length;n++){var s=e.find("#"+a[n]);t.model.links.push(s[0].value)}},i.prototype.populateFormWithModel=function(e){var t=this;t.parent.populateFormWithModel(e);for(var i="related-link-url",n=(e.find("#related-link-list"),e.find("#add-link-btn")),o=0;o<t.model.links.length;o++)n.click(),e.find("."+i).last().val(t.model.links[o])},i.prototype.initModal=function(e){var t=this,i="related-link-url",n="remove-link-btn",o=e.find("#related-link-list"),d=e.find("#add-link-btn");d.click(function(){var e=r();a.push(e),o.append('<div class="'+i+'"><div class="embed-modal-form"><input id="'+e+'" type="url" placeholder="link url" class="embed-modal-form-control" required></div><button class="'+n+'"><i class="fa fa-minus"></i></button></div>'),$("#"+e).keydown(function(){$("#"+e).keydown(s("#"+e,t))})}),e.on("click","."+n,function(){$(document.activeElement).closest("."+i).remove()})},i.prototype.clearForm=function(e){var t=this;t.parent.clearForm(e);e.find("#related-link-list");linkList.children().remove()},i.prototype.parseForEditor=function(){var e=this;return'<div class="relatedLink-embed"><p class="relatedLink-embed-uiText"> <strong>Embed Type:</strong> Related Link </p><p  class="relatedLink-embed-uiText"> <strong>Title:</strong> '+e.model.title+"</p></div>"}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,a,o,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n,o="slideshow",a={viewPath:e+"modal/modal_slideshow.html",displayName:"Slideshow",object_type:"slideshow",validationOptions:{rules:{slideshowTitle:"required",title:"required",altText:"required",license:"required"}}},r=function(){for(var e="",t=0;8>t;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e},s="#embed-modal-slideshow-image",d=".embed-modal-slideshow-image-select",l={},c=function(){var e=$(s).find("legend").attr("data-image-id");n.getModelFromForm($(s)),l[e]=n.model},u=function(e){var t=$("#"+e),i=$(s).find("legend").attr("data-image-id");i&&""!==i?(c(),n.clearForm($(s)),n.model=l[e],n.populateFormWithModel($(s))):($(s).show(),$(d).show()),$(s).find("legend").attr("data-image-id",e),$(d).val(t.val())};i.inherits(t.genericEmbed),t[o]=i,i.prototype.orderIndex=2,i.prototype.cleanModel=function(){return{title:null,images:[]}},i.prototype.initModal=function(e){var t=this;t.model=t.cleanModel(),n=$.grep(EntityEmbed.embedTypes,function(e){return"image"==e.name})[0],n.loadLicenses(),e.find("input[name='imageFile']").fileupload({dataType:"json",replaceFileInput:!1,add:function(t,i){i.submit().complete(function(t,o,a){if("success"===o){if(!t||!t.responseJSON||!t.responseJSON.path)return console.log('file upload completed with status "'+o+'"'),void console.log(t);var s=r();l[s]=n.cleanModel();var c=0;for(var p in l)c+=1;var m=$('<option id="'+s+'">image '+c+"</option>");i.context=m.appendTo(e.find(d)),u(s)}})}}),e.on("change",d,function(e){var t=$(e.currentTarget.options[e.currentTarget.selectedIndex]);u(t.attr("id"))})},i.prototype.saveEmbed=function(e,t,i){for(var o=this,a=[],r=0;r<o.model.images.length;r++){n.model=o.model.images[r],n.model.order=r;var s=!n.model.object_id;a.push(n.saveEmbed(s,function(e){"ERROR"==e.status&&console.log("failed to put/post a slideshow image"),o.model.images[e.response.order]=e.response.object_id},function(){console.log("failed to put/post a slideshow image")})),$.when.apply($,a).done(function(){return e?(o.model.object_type=o.options.object_type,EntityEmbed.apiService.post({path:o.options.httpPaths.post,data:o.model,success:t,fail:i})):EntityEmbed.apiService.put({path:o.options.httpPaths.put,data:o.model,success:t,fail:i})})}},i.prototype.getModelFromForm=function(e){var t=this;c(),t.model.title=e.find("input[name=slideshowTitle]").val(),t.model.images=[];for(var i in l)t.model.images.push(l[i])},i.prototype.clearForm=function(e){var t=this;t.parent.clearForm(e),e.find(d).children().remove(),$(s).hide(),$(d).hide(),e.find("legend").attr("data-image-id","")}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="twitter",o={viewPath:e+"modal/modal_twitter.html",displayName:"Twitter",object_type:"tweet",validationOptions:{rules:{title:"required",tweet:"required"}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=6,i.prototype.getModelFromForm=function(e){for(var t=this,i=e.find(".embed-modal-form-control"),n=0;n<i.length;n++){var o=i[n].name,a=i[n].value;o&&a&&(t.model[o]=a)}var r="embedCode",s='<blockquote class="twitter-tweet" data-lang="en" style="width:50%; margin:auto;"><a href="'+t.model.url+'"></a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>';t.model[r]=s},i.prototype.cleanModel=function(){return{title:null,url:null}},i.prototype.parseForEditor=function(){var e=this;return'<div class="twitter-embed"><div class="twitter-info"><span>click here to show the toolbars</span></div><div class="overlay">'+e.model.embedCode+'</div><div class="twitter-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes),function(e,t){"use strict";function i(e){var t=this;t.parent.constructor(e,o,n,t)}if(!t)return void console.log("Could not find EntityEmbedTypes namespace. Please ensure that the genericEmbed has loaded before this one.");var n="video",o={viewPath:e+"modal/modal_video.html",displayName:"Video",object_type:"video",validationOptions:{rules:{title:"required",url:"required"}}};i.inherits(t.genericEmbed),t[n]=i,i.prototype.orderIndex=4,i.prototype.cleanModel=function(){return{title:null,url:null}},i.prototype.parseForEditor=function(){var e=this;return $.support.cors=!0,$.ajax({crossDomain:!0,cache:!1,async:!1,timeout:15e3,url:"http://medium.iframe.ly/api/oembed?iframe=1",dataType:"json",data:{url:e.model.url},success:function(t){e.model.videoHtmlString=$(t.html).find("iframe").attr("style","").prop("outerHTML")},error:function(e,t,i){}}),'<div class="video-embed"><div class="video-info"><span>click here to show the toolbars</span></div><div class="overlay"></div>'+e.model.videoHtmlString+'<div class="video-info"><span>click here to show the toolbars</span></div></div>'}}("",EntityEmbedTypes);var EntityEmbed=EntityEmbed||{};!function(e,t,i,n,o){"use strict";function a(e){var t,i,n="[[",o="]]";return i=[d,e.index,e.id].join(":"),t=[n,i,o].join("")}function r(i,n){var o=this;o.el=i,o.$el=e(i),o.templates=t.MediumInsert.Templates,o.core=o.$el.data("plugin_"+s),o.options=e.extend(!0,{},m,n),o._defaults=m,o._name=s,o.toolbarManager=new EntityEmbed.toolbarManager(o,o.options.styles,o.options.actions,c),o.core.getEditor()&&(o.core.getEditor()._serializePreEmbeds=o.core.getEditor().serialize,o.core.getEditor().serialize=o.editorSerialize,o.core.getEditor().loadStory=function(e){o.loadStory(e)}),o.init()}var s="mediumInsert",d="EntityEmbeds",l="workaround-element",c="entity-embed-active",u=".medium-insert-active",c="entity-embed-active",p="entity-embed-container",m={modalOptions:{},modalScope:{$embedTypeSelect:e(""),$modalBody:e("")},$modalEl:e(""),insertBtn:".medium-insert-buttons",fileUploadOptions:{url:"upload.php",acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},styles:{left:{label:'<span class="fa fa-align-left"></span>',added:function(e){e.addClass("clearfix")},removed:function(e){e.removeClass("clearfix")}},center:{label:'<span class="fa fa-align-center"></span>'},right:{label:'<span class="fa fa-align-right"></span>',added:function(e){e.addClass("clearfix")},removed:function(e){e.removeClass("clearfix")}},wide:{label:'<span class="fa fa-align-justify"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e,t){e.removeEmbed(t)}},edit:{label:'<span class="fa fa-cog"></span>',clicked:function(e,t){e.editEmbed(t)}},newline:{label:'<span class="fa fa-i-cursor"></span>',clicked:function(e,t){e.addNewline(t)}}},embedTypes:{image:{},video:{},audio:{},twitter:{},instagram:{},facebook:{},relatedLink:{},externalLink:{},globalBuzz:{},newsletterSubscribe:{},iframe:{},customText:{}}};r.prototype.init=function(){var t=this;t.toolbarManager.createActionToolbar(e("body")),t.events(),t.embedTypes=[];for(var i in n)if(t.options.embedTypes[i]){var o=new n[i](t.options.embedTypes[i]);t.embedTypes.push(o),t.toolbarManager.createStyleToolbar(e("body"),o)}t.embedTypes.sort(function(e,t){return e.orderIndex-t.orderIndex}),EntityEmbed.embedTypes=t.embedTypes,t.finalModalOptions={};var a=new EntityEmbed.embedModalDefaults;t.options.modalOptions?t.finalModalOptions=e.extend(!0,{},a,t.options.modalOptions):t.finalModalOptions=a;var r={embedTypes:t.embedTypes};r=e.extend(!0,{},t.options.modalScope,r),t.options.$modalEl.modal(t.finalModalOptions,r)},r.prototype.events=function(){var t=this;e(i).ready(function(){e(t.options.insertBtn).click(function(e){e.stopPropagation(),t.add()})}),e(i).on("click",function(i){e(i.target).is(".medium-editor-action")||e(i.target.parentElement).is(".medium-editor-action")||0==t.$el.find("."+c).length||(e("."+c).removeClass(c),t.toolbarManager.hideToolbar())}).on("click","."+p,function(i){t.toggleSelectEmbed(e(this)),i.stopPropagation()}).on("keydown",".editable.editor",function(t){if(8==t.which||46==t.which){var i=e(".editable.editor p").length;if(1>=i){var n=e(".editable.editor p").text();n&&""!==n||t.preventDefault()}}}).on("keydown",function(e){8!=e.which&&46!=e.which||0!=t.$el.find("."+c).length&&t.toolbarManager.hideToolbar()}).on("entityEmbedAdded","."+p,function(i){t.addEmbed(e(this),i.embedType)})},r.prototype.getCore=function(){return this.core},r.prototype.editorSerialize=function(){var t=this,i=t._serializePreEmbeds(),n={storyHtml:"",embeds:[]};return e.each(i,function(t){var o,r;o=e("<div />").html(i[t].value),r=o.find(".entity-embed-container",o),r.each(function(t){var i,o,r,s;i=e(this),o=i.find("figure"),o&&(r={index:t,id:o.attr("id"),style:o.attr("class"),type:o.attr("data-embed-type")},n.embeds.push(r),s=a(r),i.html(s))}),n.storyHtml+=o.html()}),n},r.prototype.loadStory=function(t){function i(t){var i;if(!t)return void n();if(o=t.storyHtml||"",!t.embeds)return void n();i=[];for(var s=0;s<t.embeds.length;s++)t.embeds[s].embedType=e.grep(r.embedTypes,function(e){return e.options.object_type==t.embeds[s].type})[0],t.embeds[s].embedType.model=t.embeds[s].embedType.cleanModel(),i.push(EntityEmbed.apiService.get({path:t.embeds[s].embedType.options.httpPaths.get,data:{object_id:t.embeds[s].id},success:function(e){return function(t){var i,n;"ERROR"===t.status&&console.log("failed to get embed object!"),e.embedType.model=t.response,i=r.finalModalOptions.generateEmbedHtml(e.embedType,!1),n=a(e),o=o.split(n).join(i)}}(t.embeds[s])}));e.when.apply(e,i).done(function(){n()})}function n(){r.$el.children().not("#"+l).not(r.options.insertBtn).remove(),e("#"+l).after(o),e("#"+l).remove()}var o,r=this,s="string"==typeof t;return t?(o=s?"":t.storyHtml,r.$el.append('<div id="'+l+'"></div>'),void(s?EntityEmbed.apiService.get({path:"https://test-services.pri.org/admin/embed/edit",data:{object_id:t},sucess:function(e){return"ERROR"===e.status?void console.log("Failed to get story with id "+t):void i(e.repsonse)},fail:function(e){console.log("Failed to get story with id "+t)}}):i(t))):void console.log("Must provide either story id or serialived story data.")},r.prototype.add=function(){var t=this,i={$currentEditorLocation:e(u),modalType:EntityEmbed.embedModalTypes.add};t.options.$modalEl.openModal(i)},r.prototype.editEmbed=function(t){var i=this,n={$currentEditorLocation:e("."+c),modalType:EntityEmbed.embedModalTypes.edit,embedId:t.find("figure").attr("id"),embedType:t.find("[data-embed-type]").attr("data-embed-type")};i.toolbarManager.hideToolbar(),i.options.$modalEl.openModal(n)},r.prototype.removeEmbed=function(e){var t=this;t.toolbarManager.hideToolbar(),e.remove()},r.prototype.addNewline=function(e){var t=this,i='<p class="entity-embed-new-line">&nbsp</p>';e.before(i),e.after(i),t.toolbarManager.positionToolbars(e)},r.prototype.toggleSelectEmbed=function(t){var i=this,n=e("."+c),o=t.find("[data-embed-type]").attr("data-embed-type"),a=e.grep(i.embedTypes,function(e){return e.options.object_type===o})[0].name;i.toolbarManager.hideToolbar(),n.toggleClass(c),t.toggleClass(c),i.options.actions&&(t.hasClass(c)?i.toolbarManager.showToolbars(t,a):i.toolbarManager.hideToolbar())},r.prototype.addEmbed=function(e,t){var i=this,n=t.defaultStyle.replace("entity-embed-","");i.toolbarManager.addStyle(e,t.defaultStyle,n,!1)},e.fn[s+d]=function(t){return this.each(function(){e.data(this,"plugin_"+s+d)||e.data(this,"plugin_"+s+d,new r(this,t))})}}(jQuery,window,document,EntityEmbedTypes),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){e.extend(e.fn,{validate:function(t){if(!this.length)return void(t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var i=e.data(this[0],"validator");return i?i:(this.attr("novalidate","novalidate"),i=new e.validator(t,this[0]),e.data(this[0],"validator",i),i.settings.onsubmit&&(this.on("click.validate",":submit",function(t){i.settings.submitHandler&&(i.submitButton=t.target),e(this).hasClass("cancel")&&(i.cancelSubmit=!0),void 0!==e(this).attr("formnovalidate")&&(i.cancelSubmit=!0)}),this.on("submit.validate",function(t){function n(){var n,o;return i.settings.submitHandler?(i.submitButton&&(n=e("<input type='hidden'/>").attr("name",i.submitButton.name).val(e(i.submitButton).val()).appendTo(i.currentForm)),o=i.settings.submitHandler.call(i,i.currentForm,t),i.submitButton&&n.remove(),void 0!==o?o:!1):!0}return i.settings.debug&&t.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,n()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):n():(i.focusInvalid(),!1)})),i)},valid:function(){var t,i,n;return e(this[0]).is("form")?t=this.validate().form():(n=[],t=!0,i=e(this[0].form).validate(),this.each(function(){t=i.element(this)&&t,t||(n=n.concat(i.errorList))}),i.errorList=n),t},rules:function(t,i){if(this.length){var n,o,a,r,s,d,l=this[0];if(t)switch(n=e.data(l.form,"validator").settings,o=n.rules,a=e.validator.staticRules(l),t){case"add":e.extend(a,e.validator.normalizeRule(i)),delete a.messages,o[l.name]=a,i.messages&&(n.messages[l.name]=e.extend(n.messages[l.name],i.messages));break;case"remove":return i?(d={},e.each(i.split(/\s/),function(t,i){d[i]=a[i],delete a[i],"required"===i&&e(l).removeAttr("aria-required")}),d):(delete o[l.name],a)}return r=e.validator.normalizeRules(e.extend({},e.validator.classRules(l),e.validator.attributeRules(l),e.validator.dataRules(l),e.validator.staticRules(l)),l),r.required&&(s=r.required,delete r.required,r=e.extend({required:s},r),e(l).attr("aria-required","true")),r.remote&&(s=r.remote,delete r.remote,r=e.extend(r,{remote:s})),r}}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+e(t).val())},filled:function(t){var i=e(t).val();return null!==i&&!!e.trim(""+i)},unchecked:function(t){return!e(t).prop("checked")}}),e.validator=function(t,i){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=i,this.init()},e.validator.format=function(t,i){return 1===arguments.length?function(){var i=e.makeArray(arguments);return i.unshift(t),e.validator.format.apply(this,i)}:void 0===i?t:(arguments.length>2&&i.constructor!==Array&&(i=e.makeArray(arguments).slice(1)),i.constructor!==Array&&(i=[i]),e.each(i,function(e,i){t=t.replace(new RegExp("\\{"+e+"\\}","g"),function(){return i})}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(e)))},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(t,i){var n=[16,17,18,20,35,36,37,38,39,40,45,144,225];9===i.which&&""===this.elementValue(t)||-1!==e.inArray(i.keyCode,n)||(t.name in this.submitted||t.name in this.invalid)&&this.element(t)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,i,n){"radio"===t.type?this.findByName(t.name).addClass(i).removeClass(n):e(t).addClass(i).removeClass(n)},unhighlight:function(t,i,n){"radio"===t.type?this.findByName(t.name).removeClass(i).addClass(n):e(t).removeClass(i).addClass(n)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}."),step:e.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){function t(t){var i=e.data(this.form,"validator"),n="on"+t.type.replace(/^validate/,""),o=i.settings;o[n]&&!e(this).is(o.ignore)&&o[n].call(i,this,t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var i,n=this.groups={};e.each(this.settings.groups,function(t,i){"string"==typeof i&&(i=i.split(/\s/)),e.each(i,function(e,i){n[i]=t})}),i=this.settings.rules,e.each(i,function(t,n){i[t]=e.validator.normalizeRule(n)}),e(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable]",t).on("click.validate","select, option, [type='radio'], [type='checkbox']",t),this.settings.invalidHandler&&e(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler),e(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){var i,n,o=this.clean(t),a=this.validationTargetFor(o),r=this,s=!0;return void 0===a?delete this.invalid[o.name]:(this.prepareElement(a),this.currentElements=e(a),n=this.groups[a.name],n&&e.each(this.groups,function(e,t){t===n&&e!==a.name&&(o=r.validationTargetFor(r.clean(r.findByName(e))),o&&o.name in r.invalid&&(r.currentElements.push(o),s=s&&r.check(o)))}),i=this.check(a)!==!1,s=s&&i,i?this.invalid[a.name]=!1:this.invalid[a.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e(t).attr("aria-invalid",!i)),s},showErrors:function(t){if(t){var i=this;e.extend(this.errorMap,t),this.errorList=e.map(this.errorMap,function(e,t){return{message:e,element:i.findByName(t)[0]}}),this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var t=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(t)},resetElements:function(e){var t;if(this.settings.unhighlight)for(t=0;e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,""),this.findByName(e[t].name).removeClass(this.settings.validClass);else e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t,i=0;for(t in e)e[t]&&i++;return i},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(e){e.not(this.containers).text(""),this.addWrapper(e).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&1===e.grep(this.errorList,function(e){return e.element.name===t.name}).length&&t},elements:function(){var t=this,i={};return e(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var n=this.name||e(this).attr("name");return!n&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.hasAttribute("contenteditable")&&(this.form=e(this).closest("form")[0]),n in i||!t.objectLength(e(this).rules())?!1:(i[n]=!0,!0)})},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.split(" ").join(".");return e(this.settings.errorElement+"."+t,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([])},reset:function(){this.resetInternals(),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var i,n,o=e(t),a=t.type;return"radio"===a||"checkbox"===a?this.findByName(t.name).filter(":checked").val():"number"===a&&"undefined"!=typeof t.validity?t.validity.badInput?"NaN":o.val():(i=t.hasAttribute("contenteditable")?o.text():o.val(),"file"===a?"C:\\fakepath\\"===i.substr(0,12)?i.substr(12):(n=i.lastIndexOf("/"),n>=0?i.substr(n+1):(n=i.lastIndexOf("\\"),n>=0?i.substr(n+1):i)):"string"==typeof i?i.replace(/\r/g,""):i)},check:function(t){t=this.validationTargetFor(this.clean(t));var i,n,o,a=e(t).rules(),r=e.map(a,function(e,t){return t}).length,s=!1,d=this.elementValue(t);if("function"==typeof a.normalizer){if(d=a.normalizer.call(t,d),"string"!=typeof d)throw new TypeError("The normalizer should return a string value.");delete a.normalizer}for(n in a){o={method:n,parameters:a[n]};try{if(i=e.validator.methods[n].call(this,d,t,o.parameters),"dependency-mismatch"===i&&1===r){s=!0;continue}if(s=!1,"pending"===i)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!i)return this.formatAndAdd(t,o),!1}catch(l){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+o.method+"' method.",l),l instanceof TypeError&&(l.message+=".  Exception occurred when checking element "+t.id+", check the '"+o.method+"' method."),l}}if(!s)return this.objectLength(a)&&this.successList.push(t),!0},customDataMessage:function(t,i){return e(t).data("msg"+i.charAt(0).toUpperCase()+i.substring(1).toLowerCase())||e(t).data("msg")},customMessage:function(e,t){var i=this.settings.messages[e];return i&&(i.constructor===String?i:i[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,i){var n=this.findDefined(this.customMessage(t.name,i.method),this.customDataMessage(t,i.method),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[i.method],"<strong>Warning: No message defined for "+t.name+"</strong>"),o=/\$?\{(\d+)\}/g;return"function"==typeof n?n=n.call(this,i.parameters,t):o.test(n)&&(n=e.validator.format(n.replace(o,"{$1}"),i.parameters)),n},formatAndAdd:function(e,t){var i=this.defaultMessage(e,t);this.errorList.push({message:i,element:e,method:t.method}),this.errorMap[e.name]=i,this.submitted[e.name]=i},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t,i;for(e=0;this.errorList[e];e++)i=this.errorList[e],this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,i){var n,o,a,r,s=this.errorsFor(t),d=this.idOrName(t),l=e(t).attr("aria-describedby");s.length?(s.removeClass(this.settings.validClass).addClass(this.settings.errorClass),s.html(i)):(s=e("<"+this.settings.errorElement+">").attr("id",d+"-error").addClass(this.settings.errorClass).html(i||""),n=s,this.settings.wrapper&&(n=s.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(n):this.settings.errorPlacement?this.settings.errorPlacement(n,e(t)):n.insertAfter(t),s.is("label")?s.attr("for",d):0===s.parents("label[for='"+this.escapeCssMeta(d)+"']").length&&(a=s.attr("id"),l?l.match(new RegExp("\\b"+this.escapeCssMeta(a)+"\\b"))||(l+=" "+a):l=a,e(t).attr("aria-describedby",l),o=this.groups[t.name],o&&(r=this,e.each(r.groups,function(t,i){i===o&&e("[name='"+r.escapeCssMeta(t)+"']",r.currentForm).attr("aria-describedby",s.attr("id"))})))),!i&&this.settings.success&&(s.text(""),"string"==typeof this.settings.success?s.addClass(this.settings.success):this.settings.success(s,t)),this.toShow=this.toShow.add(s)},errorsFor:function(t){var i=this.escapeCssMeta(this.idOrName(t)),n=e(t).attr("aria-describedby"),o="label[for='"+i+"'], label[for='"+i+"'] *";return n&&(o=o+", #"+this.escapeCssMeta(n).replace(/\s+/g,", #")),this.errors().filter(o)},escapeCssMeta:function(e){return e.replace(/([\\!"#$%&'()*+,.\/:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name)),e(t).not(this.settings.ignore)[0]},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+this.escapeCssMeta(t)+"']")},getLength:function(t,i){switch(i.nodeName.toLowerCase()){case"select":return e("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return t.length},depend:function(e,t){return this.dependTypes[typeof e]?this.dependTypes[typeof e](e,t):!0},dependTypes:{"boolean":function(e){return e},string:function(t,i){return!!e(t,i.form).length},"function":function(e,t){return e(t)}},optional:function(t){var i=this.elementValue(t);return!e.validator.methods.required.call(this,i,t)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,e(t).addClass(this.settings.pendingClass),this.pending[t.name]=!0)},stopRequest:function(t,i){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],e(t).removeClass(this.settings.pendingClass),i&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!i&&0===this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t,i){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,{method:i})})},destroy:function(){this.resetForm(),e(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,i){t.constructor===String?this.classRuleSettings[t]=i:e.extend(this.classRuleSettings,t)},classRules:function(t){var i={},n=e(t).attr("class");return n&&e.each(n.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(i,e.validator.classRuleSettings[this])}),i},normalizeAttributeRule:function(e,t,i,n){/min|max|step/.test(i)&&(null===t||/number|range|text/.test(t))&&(n=Number(n),isNaN(n)&&(n=void 0)),n||0===n?e[i]=n:t===i&&"range"!==t&&(e[i]=!0)},attributeRules:function(t){var i,n,o={},a=e(t),r=t.getAttribute("type");for(i in e.validator.methods)"required"===i?(n=t.getAttribute(i),""===n&&(n=!0),n=!!n):n=a.attr(i),this.normalizeAttributeRule(o,r,i,n);return o.maxlength&&/-1|2147483647|524288/.test(o.maxlength)&&delete o.maxlength,o},dataRules:function(t){var i,n,o={},a=e(t),r=t.getAttribute("type");for(i in e.validator.methods)n=a.data("rule"+i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()),this.normalizeAttributeRule(o,r,i,n);return o},staticRules:function(t){var i={},n=e.data(t.form,"validator");return n.settings.rules&&(i=e.validator.normalizeRule(n.settings.rules[t.name])||{}),i},normalizeRules:function(t,i){return e.each(t,function(n,o){if(o===!1)return void delete t[n];
if(o.param||o.depends){var a=!0;switch(typeof o.depends){case"string":a=!!e(o.depends,i.form).length;break;case"function":a=o.depends.call(i,i)}a?t[n]=void 0!==o.param?o.param:!0:(e.data(i.form,"validator").resetElements(e(i)),delete t[n])}}),e.each(t,function(n,o){t[n]=e.isFunction(o)&&"normalizer"!==n?o(i):o}),e.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){var i;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(i=t[this].replace(/[\[\]]/g,"").split(/[\s,]+/),t[this]=[Number(i[0]),Number(i[1])]))}),e.validator.autoCreateRanges&&(null!=t.min&&null!=t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),null!=t.minlength&&null!=t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var i={};e.each(t.split(/\s/),function(){i[this]=!0}),t=i}return t},addMethod:function(t,i,n){e.validator.methods[t]=i,e.validator.messages[t]=void 0!==n?n:e.validator.messages[t],i.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,i,n){if(!this.depend(n,i))return"dependency-mismatch";if("select"===i.nodeName.toLowerCase()){var o=e(i).val();return o&&o.length>0}return this.checkable(i)?this.getLength(t,i)>0:t.length>0},email:function(e,t){return this.optional(t)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)},url:function(e,t){return this.optional(t)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e).toString())},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:function(e,t){return this.optional(t)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},minlength:function(t,i,n){var o=e.isArray(t)?t.length:this.getLength(t,i);return this.optional(i)||o>=n},maxlength:function(t,i,n){var o=e.isArray(t)?t.length:this.getLength(t,i);return this.optional(i)||n>=o},rangelength:function(t,i,n){var o=e.isArray(t)?t.length:this.getLength(t,i);return this.optional(i)||o>=n[0]&&o<=n[1]},min:function(e,t,i){return this.optional(t)||e>=i},max:function(e,t,i){return this.optional(t)||i>=e},range:function(e,t,i){return this.optional(t)||e>=i[0]&&e<=i[1]},step:function(t,i,n){var o=e(i).attr("type"),a="Step attribute on input type "+o+" is not supported.",r=["text","number","range"],s=new RegExp("\\b"+o+"\\b"),d=o&&!s.test(r.join());if(d)throw new Error(a);return this.optional(i)||t%n===0},equalTo:function(t,i,n){var o=e(n);return this.settings.onfocusout&&o.not(".validate-equalTo-blur").length&&o.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){e(i).valid()}),t===o.val()},remote:function(t,i,n,o){if(this.optional(i))return"dependency-mismatch";o="string"==typeof o&&o||"remote";var a,r,s,d=this.previousValue(i,o);return this.settings.messages[i.name]||(this.settings.messages[i.name]={}),d.originalMessage=d.originalMessage||this.settings.messages[i.name][o],this.settings.messages[i.name][o]=d.message,n="string"==typeof n&&{url:n}||n,s=e.param(e.extend({data:t},n.data)),d.old===s?d.valid:(d.old=s,a=this,this.startRequest(i),r={},r[i.name]=t,e.ajax(e.extend(!0,{mode:"abort",port:"validate"+i.name,dataType:"json",data:r,context:a.currentForm,success:function(e){var n,r,s,l=e===!0||"true"===e;a.settings.messages[i.name][o]=d.originalMessage,l?(s=a.formSubmitted,a.resetInternals(),a.toHide=a.errorsFor(i),a.formSubmitted=s,a.successList.push(i),a.invalid[i.name]=!1,a.showErrors()):(n={},r=e||a.defaultMessage(i,{method:o,parameters:t}),n[i.name]=d.message=r,a.invalid[i.name]=!0,a.showErrors(n)),d.valid=l,a.stopRequest(i,l)}},n)),"pending")}}});var t,i={};e.ajaxPrefilter?e.ajaxPrefilter(function(e,t,n){var o=e.port;"abort"===e.mode&&(i[o]&&i[o].abort(),i[o]=n)}):(t=e.ajax,e.ajax=function(n){var o=("mode"in n?n:e.ajaxSettings).mode,a=("port"in n?n:e.ajaxSettings).port;return"abort"===o?(i[a]&&i[a].abort(),i[a]=t.apply(this,arguments),i[a]):t.apply(this,arguments)})}),function(e){"function"==typeof define&&define.amd?define(["jquery","./jquery.validate"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){!function(){function t(e){return e.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'\"_+=\/\-]*/g,"")}e.validator.addMethod("maxWords",function(e,i,n){return this.optional(i)||t(e).match(/\b\w+\b/g).length<=n},e.validator.format("Please enter {0} words or less.")),e.validator.addMethod("minWords",function(e,i,n){return this.optional(i)||t(e).match(/\b\w+\b/g).length>=n},e.validator.format("Please enter at least {0} words.")),e.validator.addMethod("rangeWords",function(e,i,n){var o=t(e),a=/\b\w+\b/g;return this.optional(i)||o.match(a).length>=n[0]&&o.match(a).length<=n[1]},e.validator.format("Please enter between {0} and {1} words."))}(),e.validator.addMethod("accept",function(t,i,n){var o,a,r,s="string"==typeof n?n.replace(/\s/g,""):"image/*",d=this.optional(i);if(d)return d;if("file"===e(i).attr("type")&&(s=s.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$&").replace(/,/g,"|").replace("/*","/.*"),i.files&&i.files.length))for(r=new RegExp(".?("+s+")$","i"),o=0;o<i.files.length;o++)if(a=i.files[o],!a.type.match(r))return!1;return!0},e.validator.format("Please enter a value with a valid mimetype.")),e.validator.addMethod("alphanumeric",function(e,t){return this.optional(t)||/^\w+$/i.test(e)},"Letters, numbers, and underscores only please"),e.validator.addMethod("bankaccountNL",function(e,t){if(this.optional(t))return!0;if(!/^[0-9]{9}|([0-9]{2} ){3}[0-9]{3}$/.test(e))return!1;var i,n,o,a=e.replace(/ /g,""),r=0,s=a.length;for(i=0;s>i;i++)n=s-i,o=a.substring(i,i+1),r+=n*o;return r%11===0},"Please specify a valid bank account number"),e.validator.addMethod("bankorgiroaccountNL",function(t,i){return this.optional(i)||e.validator.methods.bankaccountNL.call(this,t,i)||e.validator.methods.giroaccountNL.call(this,t,i)},"Please specify a valid bank or giro account number"),e.validator.addMethod("bic",function(e,t){return this.optional(t)||/^([A-Z]{6}[A-Z2-9][A-NP-Z1-9])(X{3}|[A-WY-Z0-9][A-Z0-9]{2})?$/.test(e.toUpperCase())},"Please specify a valid BIC code"),e.validator.addMethod("cifES",function(e){"use strict";var t,i,n,o,a,r,s=[];if(e=e.toUpperCase(),!e.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)"))return!1;for(n=0;9>n;n++)s[n]=parseInt(e.charAt(n),10);for(i=s[2]+s[4]+s[6],o=1;8>o;o+=2)a=(2*s[o]).toString(),r=a.charAt(1),i+=parseInt(a.charAt(0),10)+(""===r?0:parseInt(r,10));return/^[ABCDEFGHJNPQRSUVW]{1}/.test(e)?(i+="",t=10-parseInt(i.charAt(i.length-1),10),e+=t,s[8].toString()===String.fromCharCode(64+t)||s[8].toString()===e.charAt(e.length-1)):!1},"Please specify a valid CIF number."),e.validator.addMethod("cpfBR",function(e){if(e=e.replace(/([~!@#$%^&*()_+=`{}\[\]\-|\\:;'<>,.\/? ])+/g,""),11!==e.length)return!1;var t,i,n,o,a=0;if(t=parseInt(e.substring(9,10),10),i=parseInt(e.substring(10,11),10),n=function(e,t){var i=10*e%11;return 10!==i&&11!==i||(i=0),i===t},""===e||"00000000000"===e||"11111111111"===e||"22222222222"===e||"33333333333"===e||"44444444444"===e||"55555555555"===e||"66666666666"===e||"77777777777"===e||"88888888888"===e||"99999999999"===e)return!1;for(o=1;9>=o;o++)a+=parseInt(e.substring(o-1,o),10)*(11-o);if(n(a,t)){for(a=0,o=1;10>=o;o++)a+=parseInt(e.substring(o-1,o),10)*(12-o);return n(a,i)}return!1},"Please specify a valid CPF number"),e.validator.addMethod("creditcard",function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9 \-]+/.test(e))return!1;var i,n,o=0,a=0,r=!1;if(e=e.replace(/\D/g,""),e.length<13||e.length>19)return!1;for(i=e.length-1;i>=0;i--)n=e.charAt(i),a=parseInt(n,10),r&&(a*=2)>9&&(a-=9),o+=a,r=!r;return o%10===0},"Please enter a valid credit card number."),e.validator.addMethod("creditcardtypes",function(e,t,i){if(/[^0-9\-]+/.test(e))return!1;e=e.replace(/\D/g,"");var n=0;return i.mastercard&&(n|=1),i.visa&&(n|=2),i.amex&&(n|=4),i.dinersclub&&(n|=8),i.enroute&&(n|=16),i.discover&&(n|=32),i.jcb&&(n|=64),i.unknown&&(n|=128),i.all&&(n=255),1&n&&/^(5[12345])/.test(e)?16===e.length:2&n&&/^(4)/.test(e)?16===e.length:4&n&&/^(3[47])/.test(e)?15===e.length:8&n&&/^(3(0[012345]|[68]))/.test(e)?14===e.length:16&n&&/^(2(014|149))/.test(e)?15===e.length:32&n&&/^(6011)/.test(e)?16===e.length:64&n&&/^(3)/.test(e)?16===e.length:64&n&&/^(2131|1800)/.test(e)?15===e.length:!!(128&n)},"Please enter a valid credit card number."),e.validator.addMethod("currency",function(e,t,i){var n,o="string"==typeof i,a=o?i:i[0],r=o?!0:i[1];return a=a.replace(/,/g,""),a=r?a+"]":a+"]?",n="^["+a+"([1-9]{1}[0-9]{0,2}(\\,[0-9]{3})*(\\.[0-9]{0,2})?|[1-9]{1}[0-9]{0,}(\\.[0-9]{0,2})?|0(\\.[0-9]{0,2})?|(\\.[0-9]{1,2})?)$",n=new RegExp(n),this.optional(t)||n.test(e)},"Please specify a valid currency"),e.validator.addMethod("dateFA",function(e,t){return this.optional(t)||/^[1-4]\d{3}\/((0?[1-6]\/((3[0-1])|([1-2][0-9])|(0?[1-9])))|((1[0-2]|(0?[7-9]))\/(30|([1-2][0-9])|(0?[1-9]))))$/.test(e)},e.validator.messages.date),e.validator.addMethod("dateITA",function(e,t){var i,n,o,a,r,s=!1,d=/^\d{1,2}\/\d{1,2}\/\d{4}$/;return d.test(e)?(i=e.split("/"),n=parseInt(i[0],10),o=parseInt(i[1],10),a=parseInt(i[2],10),r=new Date(Date.UTC(a,o-1,n,12,0,0,0)),s=r.getUTCFullYear()===a&&r.getUTCMonth()===o-1&&r.getUTCDate()===n):s=!1,this.optional(t)||s},e.validator.messages.date),e.validator.addMethod("dateNL",function(e,t){return this.optional(t)||/^(0?[1-9]|[12]\d|3[01])[\.\/\-](0?[1-9]|1[012])[\.\/\-]([12]\d)?(\d\d)$/.test(e)},e.validator.messages.date),e.validator.addMethod("extension",function(e,t,i){return i="string"==typeof i?i.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(new RegExp("\\.("+i+")$","i"))},e.validator.format("Please enter a value with a valid extension.")),e.validator.addMethod("giroaccountNL",function(e,t){return this.optional(t)||/^[0-9]{1,7}$/.test(e)},"Please specify a valid giro account number"),e.validator.addMethod("iban",function(e,t){if(this.optional(t))return!0;var i,n,o,a,r,s,d,l,c,u=e.replace(/ /g,"").toUpperCase(),p="",m=!0,f="",h="";if(i=u.substring(0,2),s={AL:"\\d{8}[\\dA-Z]{16}",AD:"\\d{8}[\\dA-Z]{12}",AT:"\\d{16}",AZ:"[\\dA-Z]{4}\\d{20}",BE:"\\d{12}",BH:"[A-Z]{4}[\\dA-Z]{14}",BA:"\\d{16}",BR:"\\d{23}[A-Z][\\dA-Z]",BG:"[A-Z]{4}\\d{6}[\\dA-Z]{8}",CR:"\\d{17}",HR:"\\d{17}",CY:"\\d{8}[\\dA-Z]{16}",CZ:"\\d{20}",DK:"\\d{14}",DO:"[A-Z]{4}\\d{20}",EE:"\\d{16}",FO:"\\d{14}",FI:"\\d{14}",FR:"\\d{10}[\\dA-Z]{11}\\d{2}",GE:"[\\dA-Z]{2}\\d{16}",DE:"\\d{18}",GI:"[A-Z]{4}[\\dA-Z]{15}",GR:"\\d{7}[\\dA-Z]{16}",GL:"\\d{14}",GT:"[\\dA-Z]{4}[\\dA-Z]{20}",HU:"\\d{24}",IS:"\\d{22}",IE:"[\\dA-Z]{4}\\d{14}",IL:"\\d{19}",IT:"[A-Z]\\d{10}[\\dA-Z]{12}",KZ:"\\d{3}[\\dA-Z]{13}",KW:"[A-Z]{4}[\\dA-Z]{22}",LV:"[A-Z]{4}[\\dA-Z]{13}",LB:"\\d{4}[\\dA-Z]{20}",LI:"\\d{5}[\\dA-Z]{12}",LT:"\\d{16}",LU:"\\d{3}[\\dA-Z]{13}",MK:"\\d{3}[\\dA-Z]{10}\\d{2}",MT:"[A-Z]{4}\\d{5}[\\dA-Z]{18}",MR:"\\d{23}",MU:"[A-Z]{4}\\d{19}[A-Z]{3}",MC:"\\d{10}[\\dA-Z]{11}\\d{2}",MD:"[\\dA-Z]{2}\\d{18}",ME:"\\d{18}",NL:"[A-Z]{4}\\d{10}",NO:"\\d{11}",PK:"[\\dA-Z]{4}\\d{16}",PS:"[\\dA-Z]{4}\\d{21}",PL:"\\d{24}",PT:"\\d{21}",RO:"[A-Z]{4}[\\dA-Z]{16}",SM:"[A-Z]\\d{10}[\\dA-Z]{12}",SA:"\\d{2}[\\dA-Z]{18}",RS:"\\d{18}",SK:"\\d{20}",SI:"\\d{15}",ES:"\\d{20}",SE:"\\d{20}",CH:"\\d{5}[\\dA-Z]{12}",TN:"\\d{20}",TR:"\\d{5}[\\dA-Z]{17}",AE:"\\d{3}\\d{16}",GB:"[A-Z]{4}\\d{14}",VG:"[\\dA-Z]{4}\\d{16}"},r=s[i],"undefined"!=typeof r&&(d=new RegExp("^[A-Z]{2}\\d{2}"+r+"$",""),!d.test(u)))return!1;for(n=u.substring(4,u.length)+u.substring(0,4),l=0;l<n.length;l++)o=n.charAt(l),"0"!==o&&(m=!1),m||(p+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(o));for(c=0;c<p.length;c++)a=p.charAt(c),h=""+f+a,f=h%97;return 1===f},"Please specify a valid IBAN"),e.validator.addMethod("integer",function(e,t){return this.optional(t)||/^-?\d+$/.test(e)},"A positive or negative non-decimal number please"),e.validator.addMethod("ipv4",function(e,t){return this.optional(t)||/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(e)},"Please enter a valid IP v4 address."),e.validator.addMethod("ipv6",function(e,t){return this.optional(t)||/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(e)},"Please enter a valid IP v6 address."),e.validator.addMethod("lettersonly",function(e,t){return this.optional(t)||/^[a-z]+$/i.test(e)},"Letters only please"),e.validator.addMethod("letterswithbasicpunc",function(e,t){return this.optional(t)||/^[a-z\-.,()'"\s]+$/i.test(e)},"Letters or punctuation only please"),e.validator.addMethod("mobileNL",function(e,t){return this.optional(t)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)6((\s|\s?\-\s?)?[0-9]){8}$/.test(e)},"Please specify a valid mobile number"),e.validator.addMethod("mobileUK",function(e,t){return e=e.replace(/\(|\)|\s+|-/g,""),this.optional(t)||e.length>9&&e.match(/^(?:(?:(?:00\s?|\+)44\s?|0)7(?:[1345789]\d{2}|624)\s?\d{3}\s?\d{3})$/)},"Please specify a valid mobile number"),e.validator.addMethod("nieES",function(e){"use strict";return e=e.toUpperCase(),e.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)")?/^[T]{1}/.test(e)?e[8]===/^[T]{1}[A-Z0-9]{8}$/.test(e):/^[XYZ]{1}/.test(e)?e[8]==="TRWAGMYFPDXBNJZSQVHLCKE".charAt(e.replace("X","0").replace("Y","1").replace("Z","2").substring(0,8)%23):!1:!1},"Please specify a valid NIE number."),e.validator.addMethod("nifES",function(e){"use strict";return e=e.toUpperCase(),e.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)")?/^[0-9]{8}[A-Z]{1}$/.test(e)?"TRWAGMYFPDXBNJZSQVHLCKE".charAt(e.substring(8,0)%23)===e.charAt(8):/^[KLM]{1}/.test(e)?e[8]===String.fromCharCode(64):!1:!1},"Please specify a valid NIF number."),jQuery.validator.addMethod("notEqualTo",function(t,i,n){return this.optional(i)||!e.validator.methods.equalTo.call(this,t,i,n)},"Please enter a different value, values must not be the same."),e.validator.addMethod("nowhitespace",function(e,t){return this.optional(t)||/^\S+$/i.test(e)},"No white space please"),e.validator.addMethod("pattern",function(e,t,i){return this.optional(t)?!0:("string"==typeof i&&(i=new RegExp("^(?:"+i+")$")),i.test(e))},"Invalid format."),e.validator.addMethod("phoneNL",function(e,t){return this.optional(t)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)[1-9]((\s|\s?\-\s?)?[0-9]){8}$/.test(e)},"Please specify a valid phone number."),e.validator.addMethod("phoneUK",function(e,t){return e=e.replace(/\(|\)|\s+|-/g,""),this.optional(t)||e.length>9&&e.match(/^(?:(?:(?:00\s?|\+)44\s?)|(?:\(?0))(?:\d{2}\)?\s?\d{4}\s?\d{4}|\d{3}\)?\s?\d{3}\s?\d{3,4}|\d{4}\)?\s?(?:\d{5}|\d{3}\s?\d{3})|\d{5}\)?\s?\d{4,5})$/)},"Please specify a valid phone number"),e.validator.addMethod("phoneUS",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]([02-9]\d|1[02-9])\)|[2-9]([02-9]\d|1[02-9]))-?[2-9]([02-9]\d|1[02-9])-?\d{4}$/)},"Please specify a valid phone number"),e.validator.addMethod("phonesUK",function(e,t){return e=e.replace(/\(|\)|\s+|-/g,""),this.optional(t)||e.length>9&&e.match(/^(?:(?:(?:00\s?|\+)44\s?|0)(?:1\d{8,9}|[23]\d{9}|7(?:[1345789]\d{8}|624\d{6})))$/)},"Please specify a valid uk phone number"),e.validator.addMethod("postalCodeCA",function(e,t){return this.optional(t)||/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ] *\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i.test(e)},"Please specify a valid postal code"),e.validator.addMethod("postalcodeBR",function(e,t){return this.optional(t)||/^\d{2}.\d{3}-\d{3}?$|^\d{5}-?\d{3}?$/.test(e)},"Informe um CEP vlido."),e.validator.addMethod("postalcodeIT",function(e,t){return this.optional(t)||/^\d{5}$/.test(e)},"Please specify a valid postal code"),e.validator.addMethod("postalcodeNL",function(e,t){return this.optional(t)||/^[1-9][0-9]{3}\s?[a-zA-Z]{2}$/.test(e)},"Please specify a valid postal code"),e.validator.addMethod("postcodeUK",function(e,t){return this.optional(t)||/^((([A-PR-UWYZ][0-9])|([A-PR-UWYZ][0-9][0-9])|([A-PR-UWYZ][A-HK-Y][0-9])|([A-PR-UWYZ][A-HK-Y][0-9][0-9])|([A-PR-UWYZ][0-9][A-HJKSTUW])|([A-PR-UWYZ][A-HK-Y][0-9][ABEHMNPRVWXY]))\s?([0-9][ABD-HJLNP-UW-Z]{2})|(GIR)\s?(0AA))$/i.test(e)},"Please specify a valid UK postcode"),e.validator.addMethod("require_from_group",function(t,i,n){var o=e(n[1],i.form),a=o.eq(0),r=a.data("valid_req_grp")?a.data("valid_req_grp"):e.extend({},this),s=o.filter(function(){return r.elementValue(this)}).length>=n[0];return a.data("valid_req_grp",r),e(i).data("being_validated")||(o.data("being_validated",!0),o.each(function(){r.element(this)}),o.data("being_validated",!1)),s},e.validator.format("Please fill at least {0} of these fields.")),e.validator.addMethod("skip_or_fill_minimum",function(t,i,n){var o=e(n[1],i.form),a=o.eq(0),r=a.data("valid_skip")?a.data("valid_skip"):e.extend({},this),s=o.filter(function(){return r.elementValue(this)}).length,d=0===s||s>=n[0];return a.data("valid_skip",r),e(i).data("being_validated")||(o.data("being_validated",!0),o.each(function(){r.element(this)}),o.data("being_validated",!1)),d},e.validator.format("Please either skip these fields or fill at least {0} of them.")),e.validator.addMethod("stateUS",function(e,t,i){var n,o="undefined"==typeof i,a=o||"undefined"==typeof i.caseSensitive?!1:i.caseSensitive,r=o||"undefined"==typeof i.includeTerritories?!1:i.includeTerritories,s=o||"undefined"==typeof i.includeMilitary?!1:i.includeMilitary;return n=r||s?r&&s?"^(A[AEKLPRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$":r?"^(A[KLRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$":"^(A[AEKLPRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$":"^(A[KLRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$",n=a?new RegExp(n):new RegExp(n,"i"),this.optional(t)||n.test(e)},"Please specify a valid state"),e.validator.addMethod("strippedminlength",function(t,i,n){return e(t).text().length>=n},e.validator.format("Please enter at least {0} characters")),e.validator.addMethod("time",function(e,t){return this.optional(t)||/^([01]\d|2[0-3]|[0-9])(:[0-5]\d){1,2}$/.test(e)},"Please enter a valid time, between 00:00 and 23:59"),e.validator.addMethod("time12h",function(e,t){return this.optional(t)||/^((0?[1-9]|1[012])(:[0-5]\d){1,2}(\ ?[AP]M))$/i.test(e)},"Please enter a valid time in 12-hour am/pm format"),e.validator.addMethod("url2",function(e,t){return this.optional(t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},e.validator.messages.url),e.validator.addMethod("vinUS",function(e){if(17!==e.length)return!1;var t,i,n,o,a,r,s=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","R","S","T","U","V","W","X","Y","Z"],d=[1,2,3,4,5,6,7,8,1,2,3,4,5,7,9,2,3,4,5,6,7,8,9],l=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],c=0;for(t=0;17>t;t++){if(o=l[t],n=e.slice(t,t+1),8===t&&(r=n),isNaN(n)){for(i=0;i<s.length;i++)if(n.toUpperCase()===s[i]){n=d[i],n*=o,isNaN(r)&&8===i&&(r=s[i]);break}}else n*=o;c+=n}return a=c%11,10===a&&(a="X"),a===r},"The specified vehicle identification number (VIN) is invalid."),e.validator.addMethod("zipcodeUS",function(e,t){return this.optional(t)||/^\d{5}(-\d{4})?$/.test(e)},"The specified US ZIP Code is invalid"),e.validator.addMethod("ziprange",function(e,t){return this.optional(t)||/^90[2-5]\d\{2\}-\d{4}$/.test(e)},"Your ZIP-code must be in the range 902xx-xxxx to 905xx-xxxx")});var EasyAutocomplete=function(e){return e.Configuration=function(e){function t(){if("xml"===e.dataType&&(e.getValue||(e.getValue=function(e){return $(e).text()}),e.list||(e.list={}),e.list.sort||(e.list.sort={}),e.list.sort.method=function(t,i){return t=e.getValue(t),i=e.getValue(i),i>t?-1:t>i?1:0},e.list.match||(e.list.match={}),e.list.match.method=function(t,i){return t=e.getValue(t),i=e.getValue(i),t===i}),void 0!==e.categories&&e.categories instanceof Array){for(var t=[],i=0,n=e.categories.length;n>i;i+=1){var o=e.categories[i];for(var a in s.categories[0])void 0===o[a]&&(o[a]=s.categories[0][a]);t.push(o)}e.categories=t}}function i(){function t(e,i){var n=e||{};for(var o in e)void 0!==i[o]&&null!==i[o]&&("object"!=typeof i[o]||i[o]instanceof Array?n[o]=i[o]:t(e[o],i[o]));return void 0!==i.data&&null!==i.data&&"object"==typeof i.data&&(n.data=i.data),n}s=t(s,e)}function n(){if("list-required"!==s.url&&"function"!=typeof s.url){var t=s.url;s.url=function(){return t}}if(void 0!==s.ajaxSettings.url&&"function"!=typeof s.ajaxSettings.url){var t=s.ajaxSettings.url;s.ajaxSettings.url=function(){return t}}if("string"==typeof s.listLocation){var i=s.listLocation;s.listLocation="XML"===s.dataType.toUpperCase()?function(e){return $(e).find(i)}:function(e){return e[i]}}if("string"==typeof s.getValue){var n=s.getValue;s.getValue=function(e){return e[n]}}void 0!==e.categories&&(s.categoriesAssigned=!0)}function o(){s.ajaxSettings=void 0!==e.ajaxSettings&&"object"==typeof e.ajaxSettings?e.ajaxSettings:{}}function a(e){return void 0!==s[e]&&null!==s[e]}function r(e,t){function i(t,o){for(var a in o)void 0===t[a]&&e.log("Property '"+a+"' does not exist in EasyAutocomplete options API."),"object"!=typeof t[a]||n(a)||i(t[a],o[a])}function n(e){var t=["ajaxSettings","template"];return Array.prototype.contains=function(e){for(var t=this.length;t--;)if(this[t]===e)return!0;return!1},t.contains(e)}i(s,t)}var s={data:"list-required",url:"list-required",dataType:"json",listLocation:function(e){return e},xmlElementName:"",getValue:function(e){return e},autocompleteOff:!0,placeholder:!1,ajaxCallback:function(){},matchResponseProperty:!1,list:{sort:{enabled:!1,method:function(e,t){return e=s.getValue(e),t=s.getValue(t),t>e?-1:e>t?1:0}},maxNumberOfElements:6,hideOnEmptyPhrase:!0,match:{enabled:!1,caseSensitive:!1,method:function(e,t){return e=s.getValue(e),t=s.getValue(t),e===t}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}},onClickEvent:function(){},onSelectItemEvent:function(){},onLoadEvent:function(){},onChooseEvent:function(){},onKeyEnterEvent:function(){},onMouseOverEvent:function(){},onMouseOutEvent:function(){},onShowListEvent:function(){},onHideListEvent:function(){}},highlightPhrase:!0,theme:"",cssClasses:"",minCharNumber:0,requestDelay:0,adjustWidth:!0,ajaxSettings:{},preparePostData:function(e){return e},loggerEnabled:!0,template:"",categoriesAssigned:!1,categories:[{maxNumberOfElements:4}]};this.get=function(e){return s[e]},this.equals=function(e,t){return!(!a(e)||s[e]!==t)},this.checkDataUrlProperties=function(){return"list-required"!==s.url||"list-required"!==s.data},this.checkRequiredProperties=function(){for(var e in s)if("required"===s[e])return logger.error("Option "+e+" must be defined"),!1;return!0},this.printPropertiesThatDoesntExist=function(e,t){r(e,t)},t(),i(),s.loggerEnabled===!0&&r(console,e),o(),n()},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Logger=function(){this.error=function(e){console.log("ERROR: "+e)},this.warning=function(e){console.log("WARNING: "+e)}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Constans=function(){var e={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"eac-container-",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(t){return e[t]}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.ListBuilderService=function(e,t){function i(t,i){function n(){var n,o={};return void 0!==t.xmlElementName&&(o.xmlElementName=t.xmlElementName),void 0!==t.listLocation?n=t.listLocation:void 0!==e.get("listLocation")&&(n=e.get("listLocation")),void 0!==n?"string"==typeof n?o.data=$(i).find(n):"function"==typeof n&&(o.data=n(i)):o.data=i,o}function o(){var e={};return void 0!==t.listLocation?"string"==typeof t.listLocation?e.data=i[t.listLocation]:"function"==typeof t.listLocation&&(e.data=t.listLocation(i)):e.data=i,e}var a={};if(a="XML"===e.get("dataType").toUpperCase()?n():o(),void 0!==t.header&&(a.header=t.header),void 0!==t.maxNumberOfElements&&(a.maxNumberOfElements=t.maxNumberOfElements),void 0!==e.get("list").maxNumberOfElements&&(a.maxListSize=e.get("list").maxNumberOfElements),void 0!==t.getValue)if("string"==typeof t.getValue){var r=t.getValue;a.getValue=function(e){return e[r]}}else"function"==typeof t.getValue&&(a.getValue=t.getValue);else a.getValue=e.get("getValue");return a}function n(t){var i=[];return void 0===t.xmlElementName&&(t.xmlElementName=e.get("xmlElementName")),$(t.data).find(t.xmlElementName).each(function(){i.push(this)}),i}this.init=function(t){var i=[],n={};return n.data=e.get("listLocation")(t),n.getValue=e.get("getValue"),n.maxListSize=e.get("list").maxNumberOfElements,i.push(n),i},this.updateCategories=function(t,n){if(e.get("categoriesAssigned")){t=[];for(var o=0;o<e.get("categories").length;o+=1){var a=i(e.get("categories")[o],n);t.push(a)}}return t},this.convertXml=function(t){if("XML"===e.get("dataType").toUpperCase())for(var i=0;i<t.length;i+=1)t[i].data=n(t[i]);return t},this.processData=function(i,n){for(var o=0,a=i.length;a>o;o+=1)i[o].data=t(e,i[o],n);return i},this.checkIfDataExists=function(e){for(var t=0,i=e.length;i>t;t+=1)if(void 0!==e[t].data&&e[t].data instanceof Array&&e[t].data.length>0)return!0;return!1}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.proccess=function(e,t,i){function n(t,i){var n=[],o="";if(e.get("list").match.enabled)for(var a=0,r=t.length;r>a;a+=1)o=e.get("getValue")(t[a]),e.get("list").match.caseSensitive||("string"==typeof o&&(o=o.toLowerCase()),i=i.toLowerCase()),o.search(i)>-1&&n.push(t[a]);else n=t;return n}function o(e){return void 0!==t.maxNumberOfElements&&e.length>t.maxNumberOfElements&&(e=e.slice(0,t.maxNumberOfElements)),e}function a(t){return e.get("list").sort.enabled&&t.sort(e.get("list").sort.method),t}var r=t.data,s=i;return r=n(r,s),r=o(r),r=a(r)},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Template=function(e){var t={basic:{type:"basic",method:function(e){return e},cssClass:""},description:{type:"description",fields:{description:"description"},method:function(e){return e+" - description"},cssClass:"eac-description"},iconLeft:{type:"iconLeft",fields:{icon:""},method:function(e){return e},cssClass:"eac-icon-left"},iconRight:{type:"iconRight",fields:{iconSrc:""},method:function(e){return e},cssClass:"eac-icon-right"},links:{type:"links",fields:{link:""},method:function(e){return e},cssClass:""},custom:{type:"custom",method:function(){},cssClass:""}},i=function(e){var i,n=e.fields;return"description"===e.type?(i=t.description.method,"string"==typeof n.description?i=function(e,t){return e+" - <span>"+t[n.description]+"</span>"}:"function"==typeof n.description&&(i=function(e,t){return e+" - <span>"+n.description(t)+"</span>"}),i):"iconRight"===e.type?("string"==typeof n.iconSrc?i=function(e,t){return e+"<img class='eac-icon' src='"+t[n.iconSrc]+"' />"}:"function"==typeof n.iconSrc&&(i=function(e,t){return e+"<img class='eac-icon' src='"+n.iconSrc(t)+"' />"}),i):"iconLeft"===e.type?("string"==typeof n.iconSrc?i=function(e,t){return"<img class='eac-icon' src='"+t[n.iconSrc]+"' />"+e}:"function"==typeof n.iconSrc&&(i=function(e,t){return"<img class='eac-icon' src='"+n.iconSrc(t)+"' />"+e}),i):"links"===e.type?("string"==typeof n.link?i=function(e,t){return"<a href='"+t[n.link]+"' >"+e+"</a>"}:"function"==typeof n.link&&(i=function(e,t){return"<a href='"+n.link(t)+"' >"+e+"</a>"}),i):"custom"===e.type?e.method:t.basic.method},n=function(e){return e&&e.type&&e.type&&t[e.type]?i(e):t.basic.method},o=function(e){var i=function(){return""};return e&&e.type&&e.type&&t[e.type]?function(){var i=t[e.type].cssClass;return function(){return i}}():i};this.getTemplateClass=o(e),this.build=n(e)},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.main=function(t,i){function n(){return 0===y.length?void h.error("Input field doesn't exist."):f.checkDataUrlProperties()?f.checkRequiredProperties()?(o(),void r()):void h.error("Will not work without mentioned properties."):void h.error("One of options variables 'data' or 'url' must be defined.")}function o(){function e(){var e=$("<div>"),i=m.getValue("WRAPPER_CSS_CLASS");f.get("theme")&&""!==f.get("theme")&&(i+=" eac-"+f.get("theme")),f.get("cssClasses")&&""!==f.get("cssClasses")&&(i+=" "+f.get("cssClasses")),""!==g.getTemplateClass()&&(i+=" "+g.getTemplateClass()),e.addClass(i),y.wrap(e),f.get("adjustWidth")===!0&&t()}function t(){var e=y.outerWidth();y.parent().css("width",e)}function i(){y.unwrap()}function n(){var e=$("<div>").addClass(m.getValue("CONTAINER_CLASS"));e.attr("id",a()).prepend($("<ul>")),function(){e.on("show.eac",function(){switch(f.get("list").showAnimation.type){case"slide":var t=f.get("list").showAnimation.time,i=f.get("list").showAnimation.callback;e.find("ul").slideDown(t,i);break;case"fade":var t=f.get("list").showAnimation.time,i=f.get("list").showAnimation.callback;e.find("ul").fadeIn(t),i;break;default:e.find("ul").show()}f.get("list").onShowListEvent()}).on("hide.eac",function(){switch(f.get("list").hideAnimation.type){case"slide":var t=f.get("list").hideAnimation.time,i=f.get("list").hideAnimation.callback;
e.find("ul").slideUp(t,i);break;case"fade":var t=f.get("list").hideAnimation.time,i=f.get("list").hideAnimation.callback;e.find("ul").fadeOut(t,i);break;default:e.find("ul").hide()}f.get("list").onHideListEvent()}).on("selectElement.eac",function(){e.find("ul li").removeClass("selected"),e.find("ul li").eq(A).addClass("selected"),f.get("list").onSelectItemEvent()}).on("loadElements.eac",function(t,i,n){var o="",a=e.find("ul");a.empty().detach(),T=[];for(var s=0,d=0,c=i.length;c>d;d+=1){var u=i[d].data;if(0!==u.length){void 0!==i[d].header&&i[d].header.length>0&&a.append("<div class='eac-category' >"+i[d].header+"</div>");for(var p=0,m=u.length;m>p&&s<i[d].maxListSize;p+=1)o=$("<li><div class='eac-item'></div></li>"),function(){var e=p,t=s,a=i[d].getValue(u[e]);o.find(" > div").on("click",function(){y.val(a).trigger("change"),A=t,l(t),f.get("list").onClickEvent(),f.get("list").onChooseEvent()}).mouseover(function(){A=t,l(t),f.get("list").onMouseOverEvent()}).mouseout(function(){f.get("list").onMouseOutEvent()}).html(g.build(r(a,n),u[e]))}(),a.append(o),T.push(u[p]),s+=1}}e.append(a),f.get("list").onLoadEvent()})}(),y.after(e)}function o(){y.next("."+m.getValue("CONTAINER_CLASS")).remove()}function r(e,t){return f.get("highlightPhrase")&&""!==t?d(e,t):e}function s(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function d(e,t){var i=s(t);return(e+"").replace(new RegExp("("+i+")","gi"),"<b>$1</b>")}y.parent().hasClass(m.getValue("WRAPPER_CSS_CLASS"))&&(o(),i()),e(),n(),E=$("#"+a()),f.get("placeholder")&&y.attr("placeholder",f.get("placeholder"))}function a(){var e=y.attr("id");return e=m.getValue("CONTAINER_ID")+e}function r(){function e(){b("autocompleteOff",!0)&&r(),t(),i(),n(),o(),a()}function t(){y.off("keyup").keyup(function(e){function t(e){function t(){var e={},t=f.get("ajaxSettings")||{};for(var i in t)e[i]=t[i];return e}function i(e,t){return f.get("matchResponseProperty")!==!1?"string"==typeof f.get("matchResponseProperty")?t[f.get("matchResponseProperty")]===e:"function"==typeof f.get("matchResponseProperty")?f.get("matchResponseProperty")(t)===e:!0:!0}if(!(e.length<f.get("minCharNumber"))){if("list-required"!==f.get("data")){var n=f.get("data"),o=v.init(n);o=v.updateCategories(o,n),o=v.processData(o,e),c(o,e),y.parent().find("li").length>0?s():d()}var a=t();(void 0===a.url||""===a.url)&&(a.url=f.get("url")),(void 0===a.dataType||""===a.dataType)&&(a.dataType=f.get("dataType")),void 0!==a.url&&"list-required"!==a.url&&(a.url=a.url(e),a.data=f.get("preparePostData")(a.data,e),$.ajax(a).done(function(t){var n=v.init(t);n=v.updateCategories(n,t),n=v.convertXml(n),i(e,t)&&(n=v.processData(n,e),c(n,e)),v.checkIfDataExists(n)&&y.parent().find("li").length>0?s():d(),f.get("ajaxCallback")()}).fail(function(){h.warning("Fail to load response data")}).always(function(){}))}}switch(e.keyCode){case 27:d(),u();break;case 38:e.preventDefault(),T.length>0&&A>0&&(A-=1,y.val(f.get("getValue")(T[A])),l(A));break;case 40:e.preventDefault(),T.length>0&&A<T.length-1&&(A+=1,y.val(f.get("getValue")(T[A])),l(A));break;default:if(e.keyCode>40||8===e.keyCode){var i=y.val();f.get("list").hideOnEmptyPhrase!==!0||8!==e.keyCode||""!==i?f.get("requestDelay")>0?(void 0!==p&&clearTimeout(p),p=setTimeout(function(){t(i)},f.get("requestDelay"))):t(i):d()}}})}function i(){y.on("keydown",function(e){e=e||window.event;var t=e.keyCode;return 38===t?(suppressKeypress=!0,!1):void 0}).keydown(function(e){13===e.keyCode&&A>-1&&(y.val(f.get("getValue")(T[A])),f.get("list").onKeyEnterEvent(),f.get("list").onChooseEvent(),A=-1,d(),e.preventDefault())})}function n(){y.off("keypress")}function o(){y.focus(function(){""!==y.val()&&T.length>0&&(A=-1,s())})}function a(){y.blur(function(){setTimeout(function(){A=-1,d()},250)})}function r(){y.attr("autocomplete","off")}e()}function s(){E.trigger("show.eac")}function d(){E.trigger("hide.eac")}function l(e){E.trigger("selectElement.eac",e)}function c(e,t){E.trigger("loadElements.eac",[e,t])}function u(){y.trigger("blur")}var p,m=new e.Constans,f=new e.Configuration(i),h=new e.Logger,g=new e.Template(i.template),v=new e.ListBuilderService(f,e.proccess),b=f.equals,y=t,E="",T=[],A=-1;e.consts=m,this.getConstants=function(){return m},this.getConfiguration=function(){return f},this.getContainer=function(){return E},this.getSelectedItemIndex=function(){return A},this.getItemData=function(e){return T.length<e||void 0===T[e]?-1:T[e]},this.getSelectedItemData=function(){return this.getItemData(A)},this.build=function(){o()},this.init=function(){n()}},e.easyAutocompleteHandles=[],e.inputHasId=function(e){return void 0!==$(e).attr("id")&&$(e).attr("id").length>0},e.assignRandomId=function(t){var i="";do i="eac-"+Math.floor(1e4*Math.random());while(0!==$("#"+i).length);elementId=e.consts.getValue("CONTAINER_ID")+i,$(t).attr("id",i)},e}(EasyAutocomplete||{});$.fn.easyAutocomplete=function(e){return this.each(function(){var t=$(this),i=new EasyAutocomplete.main(t,e);EasyAutocomplete.inputHasId(t)||EasyAutocomplete.assignRandomId(t),i.init(),EasyAutocomplete.easyAutocompleteHandles[t.attr("id")]=i})},$.fn.getSelectedItemIndex=function(){var e=$(this).attr("id");return void 0!==e?EasyAutocomplete.easyAutocompleteHandles[e].getSelectedItemIndex():-1},$.fn.getItemData=function(e){var t=$(this).attr("id");return void 0!==t&&e>-1?EasyAutocomplete.easyAutocompleteHandles[t].getItemData(e):-1},$.fn.getSelectedItemData=function(){var e=$(this).attr("id");return void 0!==e?EasyAutocomplete.easyAutocompleteHandles[e].getSelectedItemData():-1};